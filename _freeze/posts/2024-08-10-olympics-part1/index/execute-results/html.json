{
  "hash": "62607d8ac294652da42df493aee3f2ad",
  "result": {
    "markdown": "---\ntitle: Who really wins the Olympics?\noutput:\n  html_document:\n    code_folding: show\nauthor: Liam D. Bailey\ndate: '2024-08-10'\ndescription: \"The top countries might not be who you think\"\ncategories: [R, Data viz]\nimage: \"feature.png\"\n---\n\n::: {.cell}\n\n:::\n\n\n## Introduction: Is there an easy answer?\n\n---\n\nThese type of record breaking headlines are a mainstay of Olympic coverage, but does the medal tally actually give us a true picture of a nation's Olympic achievements? Is this data suitable to compare countries over time? Although I don't have the physical prowess to actually *participate* in the Olympics, maybe I can still analyse it. Let's dig into the Olympic data bank and search for answers...\n\n[![Australia's best medal tally (Guardian)](./data/Aus_medals.png)](https://www.theguardian.com/sport/article/2024/aug/08/paris-olympics-2024-australia-gold-medal-tally-record-matt-wearn-keegan-palmer-nina-kennedy)\n\n</br>\n\n## The data\n\n---\n\nFor our source of Olympic knowledge we use the Kaggle dataset [\"120 years of Olympic history: athletes and results\"](https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results) scraped by rgriffin from http://www.sports-reference.com/. This data provides us with a wealth of knowledge on the athletes participating in the Olympics from Athens 1896 until Rio 2016.\n\n</br>\n\n## The basics: Clean the data and add some context\n\n---\n\nLet's load all the required packages. For data wrangling we have a bunch of packages from the `tidyverse`: `tidyr`, `stringr`, `readr`, and `dplyr`. We also bring in the packages `lay`, and `janitor` which help with wrangling. Next we bring in `countrycode`, which allows us to more easily switch between IOC country codes and the ISO3c standard (yes they are different!). Finally, for data visualisation, we have `ggplot2`, `shadowtext`, `scales` and `gt` (for tables).\n\nThat's quite a few packages and I'll try to make it clear where each package is needed in the code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Data wrangling\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(readr)\nlibrary(lay)\nlibrary(janitor)\nlibrary(stringr)\n## Dealing with country codes\nlibrary(countrycode)\n## Plotting\nlibrary(ggplot2)\nlibrary(shadowtext)\nlibrary(gt)\nlibrary(scales)\n```\n:::\n\n\nLet's get started on our Olympic investigation. The first thing to note is that we have data on *all* athletes, even those that did not win a medal. We also have data on each individual athlete within a team sport (e.g. basketball). This is super interesting data, but if we want to know the best performing countries, we'll need to adapt this data a bit to show *national* medal tallies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Load data\nathletes <- readr::read_csv(\"./data/athlete_events.csv\", show_col_type = FALSE)\n\nathletes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 271,116 × 15\n      ID Name     Sex     Age Height Weight Team  NOC   Games  Year Season City \n   <dbl> <chr>    <chr> <dbl>  <dbl>  <dbl> <chr> <chr> <chr> <dbl> <chr>  <chr>\n 1     1 A Dijia… M        24    180     80 China CHN   1992…  1992 Summer Barc…\n 2     2 A Lamusi M        23    170     60 China CHN   2012…  2012 Summer Lond…\n 3     3 Gunnar … M        24     NA     NA Denm… DEN   1920…  1920 Summer Antw…\n 4     4 Edgar L… M        34     NA     NA Denm… DEN   1900…  1900 Summer Paris\n 5     5 Christi… F        21    185     82 Neth… NED   1988…  1988 Winter Calg…\n 6     5 Christi… F        21    185     82 Neth… NED   1988…  1988 Winter Calg…\n 7     5 Christi… F        25    185     82 Neth… NED   1992…  1992 Winter Albe…\n 8     5 Christi… F        25    185     82 Neth… NED   1992…  1992 Winter Albe…\n 9     5 Christi… F        27    185     82 Neth… NED   1994…  1994 Winter Lill…\n10     5 Christi… F        27    185     82 Neth… NED   1994…  1994 Winter Lill…\n# ℹ 271,106 more rows\n# ℹ 3 more variables: Sport <chr>, Event <chr>, Medal <chr>\n```\n\n\n:::\n:::\n\n\nFor simplicity, let's just focus on summer Olympics and stick with post-War Olympics (1948 onwards). In our first step of data wrangling, we adjust the data so that we count the number of each medal type for each country at each games. At this stage, data are still in long format.\n\n::: {.callout-note}\nBecause most other datasets will use ISO3c codes as country identifiers, I already substitute IOC codes to ISO3c at this early stage.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nathletes_clean <- athletes |> \n  ## Focus only on Summer Olympics since London (1948)\n  filter(Season == \"Summer\" & Year >= 1948) |> \n  ## For simplicity, let's classify NA as medal \"None\"\n  ## Keeping None ensures we don't exclude countries that participated in the Olympics \n  ## but didn't win any medals\n  mutate(Medal = replace_na(Medal, \"None\"),\n         ## NOTE: There are some country names that have \"-1\" in the name\n         ## We fix these typos\n         Team = stringr::str_remove_all(Team, pattern = \"-[0-9]*\"),\n         ## Some other known typos\n         Team = case_when(Team == \"Nadine\" ~ \"Netherlands\",\n                          Team == \"Don Schufro\" ~ \"Denmark\",\n                          Team == \"Rush VII\" ~ \"Sweden\",\n                          Team %in% c(\"Gem\", \"Gem IV\", \"Yeoman\") ~ \"Bahamas\",\n                          Team == \"Tango\" ~ \"Argentina\",\n                          Team == \"Nirefs\" ~ \"Greece\",\n                          Team %in% c(\"Pan\", \"Sirene\", \"Encore\") ~ \"Norway\",\n                          Team %in% c(\"Symphony\", \"Espadarte\", \"Ma'Lindo\") ~ \"Portugal\",\n                          Team == \"June Climene\" ~ \"Singapore\",\n                          Team == \"Kurush II\" ~ \"Cuba\",\n                          Team %in% c(\"Pam\", \"Bermudes\") ~ \"Bermuda\",\n                          Team == \"Hirondelle\" ~ \"Monaco\",\n                          TRUE ~ Team)) |> \n  ## We're much more familiar with ISO codes (and need them to join other data below)\n  ## So we'll take this opportunity to switch to ISO3c codes\n  ## Convert IOC country codes to ISO3C\n  mutate(\n    ## In most cases, we can convert straight from IOC codes to ISO3c\n    ISO3c_NOC = countrycode::countrycode(NOC, origin = \"ioc\", destination = \"iso3c\"),\n    ## In some cases, the IOC codes are not recognised so we try using country names     \n    ISO3c_name = countrycode(Team, origin = \"country.name\", destination = \"iso3c\"),\n    ## There are a few cases where the countrycode package struggles and we add codes manually\n    ISO3c = case_when(\n      ## countrycode treats Soviet Union and Russia as the same\n      ## We want to keep these separate\n      NOC == \"URS\" ~ \"SUN\",\n      ## Use direct translation from IOC codes where available\n      !is.na(ISO3c_NOC) ~ ISO3c_NOC,\n      ## Otherwise, use estimates based on the English name (less reliable)\n      is.na(ISO3c_NOC) & !is.na(ISO3c_name) ~ ISO3c_name,\n      ## In a few specific cases (Cold War era states), we manually specify the country code\n      grepl(x = Team, pattern = \"Czechoslovakia\") ~ \"CSK\",\n      grepl(x = Team, pattern = \"East Germany\") ~ \"DDR\",\n      ## Rhodesia converted to Zimbabwe\n      NOC == \"RHO\" ~ \"ZWE\",\n      grepl(x = Team, pattern = \"Netherlands Antilles\") ~ \"ANT\",\n      grepl(x = Team, pattern = \"Serbia and Montenegro\") ~ \"SCG\",\n      grepl(x = Team, pattern = \"Kosovo\") ~ \"XKX\", ## Based on WorldBank\n      ## If we can't find a ISO3c match we revert back to the IOC codes\n      ## This includes athletes competing as refugees or individuals\n      TRUE ~ NOC)) |> \n  ## When medals are won by a *team* in an event we only want to count the medal once\n  group_by(Year, Season, ISO3c, Event, Medal) |> \n  slice(1) |> \n  ungroup()\n\nmedals_long <- athletes_clean |> \n  ## Count the number of each medal won by each country at each olympics\n  group_by(Year, Season, ISO3c, Medal) |> \n  summarise(n = n(),\n            country = first(Team),\n            .groups = \"drop\")\n\nmedals_long\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4,691 × 6\n    Year Season ISO3c Medal      n country    \n   <dbl> <chr>  <chr> <chr>  <int> <chr>      \n 1  1948 Summer AFG   None       2 Afghanistan\n 2  1948 Summer ARG   Bronze     1 Argentina  \n 3  1948 Summer ARG   Gold       3 Argentina  \n 4  1948 Summer ARG   None      96 Argentina  \n 5  1948 Summer ARG   Silver     3 Argentina  \n 6  1948 Summer AUS   Bronze     5 Australia  \n 7  1948 Summer AUS   Gold       2 Australia  \n 8  1948 Summer AUS   None      43 Australia  \n 9  1948 Summer AUS   Silver     6 Australia  \n10  1948 Summer AUT   Bronze     4 Austria    \n# ℹ 4,681 more rows\n```\n\n\n:::\n:::\n\n\nThis is a good start, but we would be better served by data in wide format with one column for each medal type. This is how we're more accustomed to seeing Olympic data.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nmedals_wide <- medals_long |> \n  ## Pivot wider to have column for number of medals won for each type\n  tidyr::pivot_wider(names_from = Medal, values_from = n) |> \n  ## Some countries won't have any data for a medal type (i.e. they won none).\n  ## Replace these NAs with 0\n  mutate(across(c(None, Gold, Silver, Bronze), \\(x) replace_na(x, 0))) |> \n  ## Order columns more logically\n  select(Year, Season, ISO3c, country, Gold, Silver, Bronze) |> \n  ## Arrange to show best performing country at each games using traditional ranking\n  arrange(desc(Year), Season, desc(Gold), desc(Silver), desc(Bronze)) |> \n  ## Count the total number of medals\n  mutate(total_medals = lay(pick(c(Gold, Silver, Bronze)), \\(x) sum(x)))\n\nmedals_wide\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,463 × 8\n    Year Season ISO3c country        Gold Silver Bronze total_medals\n   <dbl> <chr>  <chr> <chr>         <int>  <int>  <int>        <int>\n 1  2016 Summer USA   United States    46     37     38          121\n 2  2016 Summer GBR   Great Britain    27     23     17           67\n 3  2016 Summer CHN   China            26     18     26           70\n 4  2016 Summer RUS   Russia           19     17     20           56\n 5  2016 Summer DEU   Germany          17     10     15           42\n 6  2016 Summer JPN   Japan            12      8     21           41\n 7  2016 Summer FRA   France           10     18     14           42\n 8  2016 Summer KOR   South Korea       9      3      9           21\n 9  2016 Summer ITA   Italy             8     12      8           28\n10  2016 Summer AUS   Australia         8     11     10           29\n# ℹ 2,453 more rows\n```\n\n\n:::\n:::\n\n\nWith this data we can now look at the best Olympic performances since 1948. The table below is generated by `gt`. See [my previous blog post](https://liamdbailey.com/posts/2020-11-27-making-beautiful-tables-with-gt/) for more detail to understand how such tables are created.\n\n::: {.callout-note}\nFind out the interesting story of the Unified Team at the 1992 Olympics [here](https://en.wikipedia.org/wiki/Unified_Team_at_the_Olympics)\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nflag_db <- readr::read_csv(\"data/Country_Flags.csv\", show_col_type = FALSE) %>% \n  #Convert country names into 3-letter country codes\n  mutate(Code_raw = countrycode(sourcevar = Country, origin = \"country.name\", destination = \"iso3c\", warn = FALSE),\n         ## There are a few cases that need to be specified manually\n         Code = case_when(Country == \"Soviet Union\" ~ \"SUN\",\n                          Country == \"East Germany\" ~ \"DDR\",\n                          Country == \"Yugoslavia\" ~ \"YUG\",\n                          Country == \"Olympics\" ~ \"EUN\",\n                          TRUE ~ Code_raw)) %>% \n  select(Code, flag_URL = ImageURL)\n\n## Data to convert Years into a convenient games name (e.g. Rio 2016)\ngames_names <- readr::read_csv(\"data/games_names.csv\", show_col_type = FALSE)\n\n## Find the top 10 medal tallies of all time\nplot_data <- medals_wide |> \n  arrange(desc(Gold), desc(Silver), desc(Bronze)) |> \n  slice(1:10) |>\n  mutate(rank = 1:n()) |>\n  ## Join in info on the name of each game and the flag image URLS\n  left_join(games_names, by = \"Year\") |> \n  left_join(flag_db, by = c(\"ISO3c\" = \"Code\")) |> \n  select(rank, Game, flag_URL, country, Gold, Silver, Bronze) |> \n  mutate(total_medals = lay(pick(c(Gold, Silver, Bronze)), sum))\n\n## Create dynamic palettes to colour Gold, Silver, and Bronze columns\nperc_palette_Gold <- col_numeric(c(\"grey99\", \"#fcc861\"), domain = c(0, max(plot_data$Gold)), alpha = 0.75)\nperc_palette_Silver <- col_numeric(c(\"grey99\", \"#e5e5e5\"), domain = c(0, max(plot_data$Silver)), alpha = 0.75)\nperc_palette_Bronze <- col_numeric(c(\"grey99\", \"#dcb386\"), domain = c(0, max(plot_data$Bronze)), alpha = 0.75)\n\n## Create the gt table\nplot_data |> \n  gt() |> \n  cols_label(rank = \"\",\n             Game = \"Games\",\n             country = \"Country\",\n             Gold = \"Gold\",\n             Silver = \"Silver\",\n             Bronze = \"Bronze\",\n             total_medals = \"Total\") %>% \n  tab_header(title = md(\"Olympic medal tally\"),\n             subtitle = \"Best ever national performances (1948 - 2016)\") %>% \n  tab_source_note(source_note = \"Data: www.sports-reference.com\") %>% \n  tab_style(\n    locations = cells_column_labels(columns = everything()),\n    style     = list(\n      cell_borders(sides = \"bottom\", weight = px(3)),\n      cell_text(weight = \"bold\")\n    )\n  ) %>% \n  tab_style(\n    locations = cells_title(groups = \"title\"),\n    style     = list(\n      cell_text(weight = \"bold\", size = 24)\n    )\n  ) %>% \n  data_color(columns = c(Gold),\n             fn = perc_palette_Gold) %>%\n  data_color(columns = c(Silver),\n             fn = perc_palette_Silver) %>%\n  data_color(columns = c(Bronze),\n             fn = perc_palette_Bronze) %>%\n  opt_all_caps() %>% \n  opt_table_font(\n    font = list(\n      google_font(\"Chivo\"),\n      default_fonts()\n    )\n  ) %>%\n  cols_width(rank ~ px(40),\n             c(country) ~ px(150),\n             c(Gold,\n               Silver,\n               Bronze) ~ px(100)) %>% \n  tab_options(\n    column_labels.border.top.width = px(3),\n    column_labels.border.top.color = \"transparent\",\n    table.border.top.color = \"transparent\",\n    table.border.bottom.color = \"transparent\",\n    data_row.padding = px(3),\n    source_notes.font.size = 12,\n    heading.align = \"left\") |> \n  gt::text_transform(\n    #Apply a function to a column\n    locations = cells_body(c(flag_URL)),\n    fn = function(x) {\n      #Return an image of set dimensions\n      web_image(\n        url = x,\n        height = 12\n      )\n    }\n  ) %>% \n  #Hide column header flag_URL and reduce width\n  cols_width(c(flag_URL) ~ px(30)) %>% \n  cols_label(flag_URL = \"\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gafpcayqaw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>@import url(\"https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\n#gafpcayqaw table {\n  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gafpcayqaw thead, #gafpcayqaw tbody, #gafpcayqaw tfoot, #gafpcayqaw tr, #gafpcayqaw td, #gafpcayqaw th {\n  border-style: none;\n}\n\n#gafpcayqaw p {\n  margin: 0;\n  padding: 0;\n}\n\n#gafpcayqaw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: rgba(255, 255, 255, 0);\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gafpcayqaw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gafpcayqaw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gafpcayqaw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 3px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gafpcayqaw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gafpcayqaw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gafpcayqaw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gafpcayqaw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gafpcayqaw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gafpcayqaw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gafpcayqaw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gafpcayqaw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gafpcayqaw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gafpcayqaw .gt_row {\n  padding-top: 3px;\n  padding-bottom: 3px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gafpcayqaw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafpcayqaw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gafpcayqaw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gafpcayqaw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gafpcayqaw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafpcayqaw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gafpcayqaw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafpcayqaw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gafpcayqaw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafpcayqaw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gafpcayqaw .gt_sourcenote {\n  font-size: 12px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gafpcayqaw .gt_left {\n  text-align: left;\n}\n\n#gafpcayqaw .gt_center {\n  text-align: center;\n}\n\n#gafpcayqaw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gafpcayqaw .gt_font_normal {\n  font-weight: normal;\n}\n\n#gafpcayqaw .gt_font_bold {\n  font-weight: bold;\n}\n\n#gafpcayqaw .gt_font_italic {\n  font-style: italic;\n}\n\n#gafpcayqaw .gt_super {\n  font-size: 65%;\n}\n\n#gafpcayqaw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gafpcayqaw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gafpcayqaw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gafpcayqaw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gafpcayqaw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gafpcayqaw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gafpcayqaw .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:40px;\"/>\n    <col/>\n    <col style=\"width:30px;\"/>\n    <col style=\"width:150px;\"/>\n    <col style=\"width:100px;\"/>\n    <col style=\"width:100px;\"/>\n    <col style=\"width:100px;\"/>\n    <col/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_title gt_font_normal\" style=\"font-size: 24; font-weight: bold;\">Olympic medal tally</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Best ever national performances (1948 - 2016)</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Games\">Games</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Country\">Country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Gold\">Gold</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Silver\">Silver</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Bronze\">Bronze</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Total\">Total</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Los Angeles 1984</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FCC861; color: #000000;\">82</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #E8E8E8; color: #000000;\">61</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E9CCAE; color: #000000;\">30</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">173</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Moscow 1980</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FCC965; color: #000000;\">80</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #E5E5E5; color: #000000;\">69</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DCB386; color: #000000;\">46</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">195</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Seoul 1988</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD997; color: #000000;\">54</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #F2F2F2; color: #000000;\">31</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DCB386; color: #000000;\">46</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">131</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">China</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDB9C; color: #000000;\">51</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #F5F5F5; color: #000000;\">21</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EACFB3; color: #000000;\">28</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">100</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Munich 1972</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDC9E; color: #000000;\">50</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #F3F3F3; color: #000000;\">27</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EFD8C2; color: #000000;\">22</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">99</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Montreal 1976</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDCA0; color: #000000;\">49</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #EEEEEE; color: #000000;\">41</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E5C4A1; color: #000000;\">35</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">125</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Moscow 1980</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Flag_of_East_Germany.svg/44px-Flag_of_East_Germany.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">East Germany</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDEA4; color: #000000;\">47</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #F0F0F0; color: #000000;\">37</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DFB990; color: #000000;\">42</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">126</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Rio 2016</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDEA6; color: #000000;\">46</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #F0F0F0; color: #000000;\">37</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E3BF9A; color: #000000;\">38</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">121</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">London 2012</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDEA6; color: #000000;\">46</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #F3F3F3; color: #000000;\">28</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EACDB1; color: #000000;\">29</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">103</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Barcelona 1992</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/Olympic_flag.svg/44px-Olympic_flag.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Unified Team</td>\n<td headers=\"Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDFA8; color: #000000;\">45</td>\n<td headers=\"Silver\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">38</td>\n<td headers=\"Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EACDB1; color: #000000;\">29</td>\n<td headers=\"total_medals\" class=\"gt_row gt_right\">112</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"8\">Data: www.sports-reference.com</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n</br>\n\n## Problem 1: The Problem of (medal) Inflation\n\n---\n\nAt first the topic of Olympic success seems pretty straight forward. More medals equals more success. But if we want to compare medal tallies between years we necessarily expect that the number of *possible* medals stays the same. Otherwise a country might do 'better' just because they participated in a particularly lucrative Olympics. Does this assumption of a fixed medal pool hold up?\n\nLet's go back to our data and look at the *total number* of Gold, Silver, and Bronze medals awarded each year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnumber_medals <- medals_wide |> \n  group_by(Year) |> \n  summarise(across(c(Gold, Silver, Bronze), sum)) |> \n  ## Convert to long format for plotting\n  tidyr::pivot_longer(Gold:Bronze, names_to = \"Medal\", values_to = \"n_medals\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nplot_data <- number_medals |>\n  mutate(Medal = factor(Medal, levels = c(\"Gold\", \"Silver\", \"Bronze\")))\n\ntext_data <- plot_data |> \n  group_by(Year) |> \n  summarise(total_medals = sum(n_medals))\n\nggplot() +\n  geom_bar(data = plot_data,\n           aes(x = as.factor(Year), y = n_medals, fill = Medal),\n           position = \"stack\", stat = \"identity\", colour = \"grey20\") +\n  geom_text(data = text_data,\n            aes(x = as.factor(Year), y = total_medals,\n                label = Year), angle = 90,\n            hjust = 1.3, fontface = \"bold\", colour = \"grey10\",\n            size = 4, family = \"Chivo\") +\n  shadowtext::geom_shadowtext(data = plot_data |> \n                                slice(1:3) |> \n                                arrange(desc(Medal)) |> \n                                mutate(y = cumsum(n_medals)),\n                              aes(x = as.factor(Year),\n                                  y = y, label = Medal,\n                                  colour = Medal),\n                              bg.colour=\"grey10\",\n                              size = 4,\n                              angle = 90, hjust = 1, vjust = -1.75,\n                              fontface = \"bold\", family = \"Chivo\") +\nlabs(title = \"The Problem of (medal) Inflation\",\nsubtitle = \"Number of medals available at the Olympics has more than doubles since 1948\") +\n  scale_fill_manual(values = c(\"#fcc861\", \"#e5e5e5\", \"#dcb386\")) +\n  scale_colour_manual(values = c(\"#fcc861\", \"#e5e5e5\", \"#dcb386\")) +\n  scale_y_continuous(expand = c(0, 0, 0, 0),\n                     name = \"Number of medals\", limits = c(NA, 1000)) +\n  scale_x_discrete(expand = c(0.075, 0.075, 0.075, 0.075)) +\n  theme_classic() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_blank(),\n        axis.title.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.title.y = element_text(size = 15, colour = \"grey10\",\n                                    face = \"bold\", family = \"Chivo\"),\n        axis.text.y = element_text(size = 10, colour = \"grey10\",\n                                   face = \"bold\", family = \"Chivo\"),\n        plot.margin = margin(t = 10, b = 10, l = 15, r = 15),\n        plot.title = element_text(size = 20, face = \"bold\", family = \"Chivo\"),\n        plot.subtitle = element_text(size = 15, family = \"Chivo\"),\n        plot.background = element_rect(colour = \"black\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=864}\n:::\n:::\n\n\nThere were a total of 973 medals available in Rio 2016 (the most recent Olympics available in the data), which is 132 extra medals compared to Atlanta 1996 (841 medals) and more than *double* that available at London 1948 (439 medals).\n\nSimply looking at medal *counts* is therefore misleading. Instead, let's consider the *percentage* of medals claimed at a given Olympics.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nmedals_wide_prop <- medals_long |> \n  ## Join in total number of medals\n  left_join(number_medals, by = c(\"Year\", \"Medal\")) |>\n  ## Determine % of each medal type that a country won at those games\n  ## We keep 'None' but don't calculate a proportion\n  ## None is kept to keep countries that didn't manage to win a medal\n  mutate(perc_medal = case_when(Medal != \"None\" ~ (n/n_medals)*100,\n                                TRUE ~ NA)) |> \n  select(Year, Season, ISO3c, country, Medal, perc_medal) |> \n  ## Pivot wider to have column for number of medals won for each type\n  tidyr::pivot_wider(names_from = Medal, values_from = perc_medal, names_prefix = \"perc_\") |> \n  ## Some countries won't have any data for a medal type. Replace this with 0\n  mutate(across(c(perc_None, perc_Bronze, perc_Silver, perc_Gold), \\(x) replace_na(x, 0))) |> \n  ## Order columns more logically\n  select(Year, Season, ISO3c, country, perc_Gold, perc_Silver, perc_Bronze) |> \n  ## Arrange to show best performing country at each games using percentage ranking\n  arrange(desc(Year), Season, desc(perc_Gold), desc(perc_Silver), desc(perc_Bronze))\n\n## Also join in data on % on total medals won\ntotal_prop <- medals_wide |> \n  left_join(number_medals |> \n              group_by(Year) |> \n              summarise(total = sum(n_medals)), by = \"Year\") |> \n  mutate(perc_Total = (total_medals/total)*100) |> \n  select(Year, ISO3c, perc_Total)\n\nmedals_wide_prop <- medals_wide_prop |> \n  left_join(total_prop, by = c(\"Year\", \"ISO3c\"))\n\nmedals_wide_prop\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,463 × 8\n    Year Season ISO3c country       perc_Gold perc_Silver perc_Bronze perc_Total\n   <dbl> <chr>  <chr> <chr>             <dbl>       <dbl>       <dbl>      <dbl>\n 1  2016 Summer USA   United States     15.0       12.1         10.6       12.4 \n 2  2016 Summer GBR   Great Britain      8.79       7.52         4.72       6.89\n 3  2016 Summer CHN   China              8.47       5.88         7.22       7.19\n 4  2016 Summer RUS   Russia             6.19       5.56         5.56       5.76\n 5  2016 Summer DEU   Germany            5.54       3.27         4.17       4.32\n 6  2016 Summer JPN   Japan              3.91       2.61         5.83       4.21\n 7  2016 Summer FRA   France             3.26       5.88         3.89       4.32\n 8  2016 Summer KOR   South Korea        2.93       0.980        2.5        2.16\n 9  2016 Summer ITA   Italy              2.61       3.92         2.22       2.88\n10  2016 Summer AUS   Australia          2.61       3.59         2.78       2.98\n# ℹ 2,453 more rows\n```\n\n\n:::\n:::\n\n\nWe can now adapt our previous table to look at the 10 greatest national performances based on medal *percentage*.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nflag_db <- readr::read_csv(\"data/Country_Flags.csv\", show_col_type = FALSE) %>% \n  #Convert country names into 3-letter country codes\n  mutate(Code_raw = countrycode(sourcevar = Country, origin = \"country.name\", destination = \"iso3c\", warn = FALSE),\n         ## There are a few cases that need to be specified manually\n         Code = case_when(Country == \"Soviet Union\" ~ \"SUN\",\n                          Country == \"East Germany\" ~ \"DDR\",\n                          Country == \"Yugoslavia\" ~ \"YUG\",\n                          TRUE ~ Code_raw)) %>% \n  select(Code, flag_URL = ImageURL)\n\ngames_names <- readr::read_csv(\"data/games_names.csv\", show_col_type = FALSE)\n\nplot_data <- medals_wide_prop |> \n  arrange(desc(perc_Gold), desc(perc_Silver), desc(perc_Bronze)) |> \n  slice(1:10) |>\n  mutate(rank = 1:n()) |>\n  left_join(games_names, by = \"Year\") |> \n  left_join(flag_db, by = c(\"ISO3c\" = \"Code\")) |> \n  select(rank, Game, flag_URL, country, perc_Gold, perc_Silver, perc_Bronze, perc_Total)\n\nperc_palette_Gold <- col_numeric(c(\"grey99\", \"#fcc861\"), domain = c(0, max(plot_data$perc_Gold)), alpha = 0.75)\nperc_palette_Silver <- col_numeric(c(\"grey99\", \"#e5e5e5\"), domain = c(0, max(plot_data$perc_Silver)), alpha = 0.75)\nperc_palette_Bronze <- col_numeric(c(\"grey99\", \"#dcb386\"), domain = c(0, max(plot_data$perc_Bronze)), alpha = 0.75)\n\nplot_data |> \n  gt() |> \n  cols_label(rank = \"\",\n             Game = \"Games\",\n             country = \"Country\",\n             perc_Gold = \"Gold (%)\",\n             perc_Silver = \"Silver (%)\",\n             perc_Bronze = \"Bronze (%)\",\n             perc_Total = \"Total (%)\") %>% \n  tab_header(title = md(\"Olympic medal tally (%)\"),\n             subtitle = \"Best ever national performances (1948 - 2016)\") %>% \n  tab_source_note(source_note = \"Data: www.sports-reference.com\") %>% \n  tab_style(\n    locations = cells_column_labels(columns = everything()),\n    style     = list(\n      cell_borders(sides = \"bottom\", weight = px(3)),\n      cell_text(weight = \"bold\")\n    )\n  ) %>% \n  tab_style(\n    locations = cells_title(groups = \"title\"),\n    style     = list(\n      cell_text(weight = \"bold\", size = 24)\n    )\n  ) %>% \n  data_color(columns = c(perc_Gold),\n             fn = perc_palette_Gold) %>%\n  data_color(columns = c(perc_Silver),\n             fn = perc_palette_Silver) %>%\n  data_color(columns = c(perc_Bronze),\n             fn = perc_palette_Bronze) %>%\n  fmt_number(columns = c(perc_Gold, perc_Silver, perc_Bronze, perc_Total),\n             decimals = 2) %>%\n  opt_all_caps() %>% \n  opt_table_font(\n    font = list(\n      google_font(\"Chivo\"),\n      default_fonts()\n    )\n  ) %>%\n  cols_width(rank ~ px(40),\n             Game ~ px(150),\n             c(country) ~ px(125),\n             c(perc_Gold,\n               perc_Silver,\n               perc_Bronze,\n               perc_Total) ~ px(85)) %>% \n  tab_options(\n    column_labels.border.top.width = px(3),\n    column_labels.border.top.color = \"transparent\",\n    table.border.top.color = \"transparent\",\n    table.border.bottom.color = \"transparent\",\n    data_row.padding = px(3),\n    source_notes.font.size = 12,\n    heading.align = \"left\") |> \n  gt::text_transform(\n    #Apply a function to a column\n    locations = cells_body(c(flag_URL)),\n    fn = function(x) {\n      #Return an image of set dimensions\n      web_image(\n        url = x,\n        height = 12\n      )\n    }\n  ) %>% \n  #Hide column header flag_URL and reduce width\n  cols_width(c(flag_URL) ~ px(30)) %>% \n  cols_label(flag_URL = \"\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"xmlzfutftr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>@import url(\"https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\n#xmlzfutftr table {\n  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xmlzfutftr thead, #xmlzfutftr tbody, #xmlzfutftr tfoot, #xmlzfutftr tr, #xmlzfutftr td, #xmlzfutftr th {\n  border-style: none;\n}\n\n#xmlzfutftr p {\n  margin: 0;\n  padding: 0;\n}\n\n#xmlzfutftr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: rgba(255, 255, 255, 0);\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xmlzfutftr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xmlzfutftr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xmlzfutftr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 3px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xmlzfutftr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xmlzfutftr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xmlzfutftr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xmlzfutftr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xmlzfutftr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xmlzfutftr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xmlzfutftr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xmlzfutftr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xmlzfutftr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xmlzfutftr .gt_row {\n  padding-top: 3px;\n  padding-bottom: 3px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xmlzfutftr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xmlzfutftr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xmlzfutftr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xmlzfutftr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xmlzfutftr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xmlzfutftr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xmlzfutftr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xmlzfutftr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xmlzfutftr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xmlzfutftr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xmlzfutftr .gt_sourcenote {\n  font-size: 12px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xmlzfutftr .gt_left {\n  text-align: left;\n}\n\n#xmlzfutftr .gt_center {\n  text-align: center;\n}\n\n#xmlzfutftr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xmlzfutftr .gt_font_normal {\n  font-weight: normal;\n}\n\n#xmlzfutftr .gt_font_bold {\n  font-weight: bold;\n}\n\n#xmlzfutftr .gt_font_italic {\n  font-style: italic;\n}\n\n#xmlzfutftr .gt_super {\n  font-size: 65%;\n}\n\n#xmlzfutftr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xmlzfutftr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xmlzfutftr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xmlzfutftr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xmlzfutftr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xmlzfutftr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xmlzfutftr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;; width: 0px\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:40px;\"/>\n    <col style=\"width:150px;\"/>\n    <col style=\"width:30px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:85px;\"/>\n    <col style=\"width:85px;\"/>\n    <col style=\"width:85px;\"/>\n    <col style=\"width:85px;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_title gt_font_normal\" style=\"font-size: 24; font-weight: bold;\">Olympic medal tally (%)</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Best ever national performances (1948 - 2016)</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Games\">Games</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Country\">Country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Gold (%)\">Gold (%)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Silver (%)\">Silver (%)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Bronze (%)\">Bronze (%)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Total (%)\">Total (%)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Moscow 1980</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FCC861; color: #000000;\">39.22</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #E5E5E5; color: #000000;\">33.82</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DCB386; color: #000000;\">20.63</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">30.90</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Los Angeles 1984</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FDCB6C; color: #000000;\">36.61</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #E9E9E9; color: #000000;\">27.98</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EBD0B4; color: #000000;\">12.35</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">25.26</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Rome 1960</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD68D; color: #000000;\">28.29</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">19.46</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DEB78D; color: #000000;\">19.38</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">22.34</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Helsinki 1952</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD893; color: #000000;\">26.85</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #F3F3F3; color: #000000;\">12.58</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EDD5BD; color: #000000;\">10.83</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">16.63</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">London 1948</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD995; color: #000000;\">26.39</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">18.49</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EACEB2; color: #000000;\">12.75</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">19.13</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Mexico City 1968</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD997; color: #000000;\">25.86</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #F1F1F1; color: #000000;\">16.47</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E0BA91; color: #000000;\">18.58</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">20.30</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Munich 1972</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDA97; color: #000000;\">25.64</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #F3F3F3; color: #000000;\">13.85</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EED6BF; color: #000000;\">10.48</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">16.50</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Montreal 1976</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDB9B; color: #000000;\">24.75</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #EEEEEE; color: #000000;\">20.60</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E4C29F; color: #000000;\">16.20</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">20.39</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Melbourne 1956</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Soviet Union</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDB9D; color: #000000;\">24.18</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">18.95</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DDB68A; color: #000000;\">19.88</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">20.99</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Moscow 1980</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Flag_of_East_Germany.svg/44px-Flag_of_East_Germany.svg.png\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">East Germany</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDDA2; color: #000000;\">23.04</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #F0F0F0; color: #000000;\">18.14</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DFB990; color: #000000;\">18.83</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">19.97</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"8\">Data: www.sports-reference.com</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n</br>\n\n## Problem 2: The Problem of Politics (and Pandemics)\n\n---\n\nWe start to see performances from older Olympics (e.g. Melbourne 1956) making the cut once we account for the smaller number of medals available in those earlier years. Unfortunately, looking at the top two national performances we see another problem in our quest to calculate Olympic success. 4 of the top 10 national performances in our table come from Olympics marred by boycotts. The impressive display of the [Soviet Union in 1980](https://en.wikipedia.org/wiki/1980_Summer_Olympics_boycott) and [USA in 1984](https://en.wikipedia.org/wiki/1984_Summer_Olympics_boycott) is a bit less impressive when you remember that their major sporting rivals boycotted these games. It's hard to compare performances from boycotted games to those with full participation.\n\nOlympics is never devoid of politics, but to make things easier let's drill down on Olympics from Atlanta 1996 onwards. This avoids major issues of Olympic boycotts and it covers a period where country borders have been a bit more stable. Because our data only goes up to Rio 2016, we also avoid the Covid disrupted event of 2020/2021.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nflag_db <- readr::read_csv(\"data/Country_Flags.csv\", show_col_type = FALSE) %>% \n  #Convert country names into 3-letter country codes\n  mutate(Code_raw = countrycode(sourcevar = Country, origin = \"country.name\", destination = \"iso3c\", warn = FALSE),\n         ## There are a few cases that need to be specified manually\n         Code = case_when(Country == \"Soviet Union\" ~ \"SUN\",\n                          Country == \"East Germany\" ~ \"DDR\",\n                          Country == \"Yugoslavia\" ~ \"YUG\",\n                          TRUE ~ Code_raw)) %>% \n  select(Code, flag_URL = ImageURL)\n\ngames_names <- readr::read_csv(\"data/games_names.csv\", show_col_type = FALSE)\n\nplot_data <- medals_wide_prop |> \n  filter(Year >= 1996) |> \n  arrange(desc(perc_Gold), desc(perc_Silver), desc(perc_Bronze)) |> \n  slice(1:10) |>\n  mutate(rank = 1:n()) |>\n  left_join(games_names, by = \"Year\") |> \n  left_join(flag_db, by = c(\"ISO3c\" = \"Code\")) |> \n  select(rank, Game, flag_URL, country, perc_Gold, perc_Silver, perc_Bronze, perc_Total)\n\nperc_palette_Gold <- col_numeric(c(\"grey99\", \"#fcc861\"), domain = c(0, max(plot_data$perc_Gold)), alpha = 0.75)\nperc_palette_Silver <- col_numeric(c(\"grey99\", \"#e5e5e5\"), domain = c(0, max(plot_data$perc_Silver)), alpha = 0.75)\nperc_palette_Bronze <- col_numeric(c(\"grey99\", \"#dcb386\"), domain = c(0, max(plot_data$perc_Bronze)), alpha = 0.75)\n\nplot_data |> \n  gt() |> \n  cols_label(rank = \"\",\n             Game = \"Games\",\n             country = \"Country\",\n             perc_Gold = \"Gold (%)\",\n             perc_Silver = \"Silver (%)\",\n             perc_Bronze = \"Bronze (%)\",\n             perc_Total = \"Total (%)\") %>% \n  tab_header(title = md(\"Olympic medal tally (%)\"),\n             subtitle = \"Best national performances (1996 - 2016)\") %>% \n  tab_source_note(source_note = \"Data: www.sports-reference.com\") %>% \n  tab_style(\n    locations = cells_column_labels(columns = everything()),\n    style     = list(\n      cell_borders(sides = \"bottom\", weight = px(3)),\n      cell_text(weight = \"bold\")\n    )\n  ) %>% \n  tab_style(\n    locations = cells_title(groups = \"title\"),\n    style     = list(\n      cell_text(weight = \"bold\", size = 24)\n    )\n  ) %>% \n  data_color(columns = c(perc_Gold),\n             fn = perc_palette_Gold) %>%\n  data_color(columns = c(perc_Silver),\n             fn = perc_palette_Silver) %>%\n  data_color(columns = c(perc_Bronze),\n             fn = perc_palette_Bronze) %>%\n  fmt_number(columns = c(perc_Gold, perc_Silver, perc_Bronze, perc_Total),\n             decimals = 2) %>%\n  opt_all_caps() %>% \n  opt_table_font(\n    font = list(\n      google_font(\"Chivo\"),\n      default_fonts()\n    )\n  ) %>%\n  cols_width(rank ~ px(40),\n             c(country, Game) ~ px(125),\n             c(perc_Gold,\n               perc_Silver,\n               perc_Bronze,\n               perc_Total) ~ px(85)) %>% \n  tab_options(\n    column_labels.border.top.width = px(3),\n    column_labels.border.top.color = \"transparent\",\n    table.border.top.color = \"transparent\",\n    table.border.bottom.color = \"transparent\",\n    data_row.padding = px(3),\n    source_notes.font.size = 12,\n    heading.align = \"left\") |> \n  gt::text_transform(\n    #Apply a function to a column\n    locations = cells_body(c(flag_URL)),\n    fn = function(x) {\n      #Return an image of set dimensions\n      web_image(\n        url = x,\n        height = 12\n      )\n    }\n  ) %>% \n  #Hide column header flag_URL and reduce width\n  cols_width(c(flag_URL) ~ px(30)) %>% \n  cols_label(flag_URL = \"\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mobismweoe\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>@import url(\"https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\n#mobismweoe table {\n  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mobismweoe thead, #mobismweoe tbody, #mobismweoe tfoot, #mobismweoe tr, #mobismweoe td, #mobismweoe th {\n  border-style: none;\n}\n\n#mobismweoe p {\n  margin: 0;\n  padding: 0;\n}\n\n#mobismweoe .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: rgba(255, 255, 255, 0);\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mobismweoe .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mobismweoe .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mobismweoe .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mobismweoe .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mobismweoe .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mobismweoe .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 3px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mobismweoe .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mobismweoe .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mobismweoe .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mobismweoe .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mobismweoe .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mobismweoe .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mobismweoe .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mobismweoe .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mobismweoe .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mobismweoe .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mobismweoe .gt_row {\n  padding-top: 3px;\n  padding-bottom: 3px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mobismweoe .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mobismweoe .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mobismweoe .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mobismweoe .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mobismweoe .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mobismweoe .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mobismweoe .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mobismweoe .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mobismweoe .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mobismweoe .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mobismweoe .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mobismweoe .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mobismweoe .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mobismweoe .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mobismweoe .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mobismweoe .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mobismweoe .gt_sourcenote {\n  font-size: 12px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mobismweoe .gt_left {\n  text-align: left;\n}\n\n#mobismweoe .gt_center {\n  text-align: center;\n}\n\n#mobismweoe .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mobismweoe .gt_font_normal {\n  font-weight: normal;\n}\n\n#mobismweoe .gt_font_bold {\n  font-weight: bold;\n}\n\n#mobismweoe .gt_font_italic {\n  font-style: italic;\n}\n\n#mobismweoe .gt_super {\n  font-size: 65%;\n}\n\n#mobismweoe .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mobismweoe .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mobismweoe .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mobismweoe .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mobismweoe .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mobismweoe .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mobismweoe .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;; width: 0px\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:40px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:30px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:85px;\"/>\n    <col style=\"width:85px;\"/>\n    <col style=\"width:85px;\"/>\n    <col style=\"width:85px;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_title gt_font_normal\" style=\"font-size: 24; font-weight: bold;\">Olympic medal tally (%)</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Best national performances (1996 - 2016)</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Games\">Games</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Country\">Country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Gold (%)\">Gold (%)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Silver (%)\">Silver (%)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Bronze (%)\">Bronze (%)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Total (%)\">Total (%)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">China</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FCC861; color: #000000;\">16.89</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #F0F0F0; color: #000000;\">6.95</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E5C5A2; color: #000000;\">7.93</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">10.45</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FDCA67; color: #000000;\">16.24</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #E7E7E7; color: #000000;\">11.72</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E4C19D; color: #000000;\">8.42</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">12.01</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">London 2012</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FECD71; color: #000000;\">15.23</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #ECECEC; color: #000000;\">9.21</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E5C3A0; color: #000000;\">8.15</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">10.71</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Rio 2016</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FECE73; color: #000000;\">14.98</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #E7E7E7; color: #000000;\">12.09</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DCB386; color: #000000;\">10.56</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">12.44</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">London 2012</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">China</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD589; color: #000000;\">12.58</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #ECECEC; color: #000000;\">8.88</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #EACFB3; color: #000000;\">6.46</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">9.15</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD68E; color: #000000;\">12.04</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #EEEEEE; color: #000000;\">8.00</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E0BA91; color: #000000;\">9.51</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">9.84</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Athens 2004</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD78F; color: #000000;\">11.96</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #E5E5E5; color: #000000;\">13.00</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E5C4A2; color: #000000;\">7.98</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">10.90</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFD78F; color: #000000;\">11.92</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #E5E5E5; color: #000000;\">12.91</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #DEB78D; color: #000000;\">9.92</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">11.49</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/f/f3/Flag_of_Russia.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Russia</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDB9B; color: #000000;\">10.70</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #EBEBEB; color: #000000;\">9.33</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #E2BE98; color: #000000;\">8.90</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">9.62</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Athens 2004</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">China</td>\n<td headers=\"perc_Gold\" class=\"gt_row gt_right\" style=\"background-color: #FFDB9B; color: #000000;\">10.63</td>\n<td headers=\"perc_Silver\" class=\"gt_row gt_right\" style=\"background-color: #F2F2F2; color: #000000;\">5.67</td>\n<td headers=\"perc_Bronze\" class=\"gt_row gt_right\" style=\"background-color: #F1DECB; color: #000000;\">4.29</td>\n<td headers=\"perc_Total\" class=\"gt_row gt_right\">6.80</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"8\">Data: www.sports-reference.com</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n</br>\n\n## Problem 3: The Problem of Money\n\n---\n\nWe now see the top national performances from the past 20 years (6 Olympics) with the issue of medal inflation removed and political boycotts avoided. China and the US dominate the standings, with 9 of the top 10 performances on record. But is this really surprising considering these are the world's two largest economies with countless amounts of money to throw at sport (and the prestige it can bring)? If we really want to measure *sporting* achievement, maybe we should remove the clear advantage available to wealthy countries. Instead of just showing medal percentage, we can instead show medal percentage *per $GDP* to account for economic opportunity.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n## Load GDP data\n## From World Bank https://databank.worldbank.org/source/world-development-indicators\nGDP <- readr::read_csv(\"./data/GDP_data.csv\", skip = 4, show_col_types = FALSE) |> \n  ## Pivot longer to allow us to left join\n  tidyr::pivot_longer(cols = `1960`:`2023`, names_to = \"year\", values_to = \"gdp\") |> \n  mutate(year = as.numeric(year)) |> \n  janitor::clean_names() |> \n  select(country_code:indicator_name, year, gdp) |> \n  ## Remove countries with no GDP data\n  filter(!is.na(gdp))\n\nmedals_gdp <- medals_wide_prop |>\n  ## Join in GDP data\n  left_join(GDP, by = c(\"ISO3c\" = \"country_code\", \"Year\" = \"year\")) |> \n  ## Calculate medal % per billion$ GDP\n  mutate(gdp_bil = gdp/1e9,\n         perc_Gold_gdp = perc_Gold/gdp_bil,\n         perc_Silver_gdp = perc_Silver/gdp_bil,\n         perc_Bronze_gdp = perc_Bronze/gdp_bil) |> \n  select(Year, Season, ISO3c, country, perc_Gold_gdp:perc_Bronze_gdp, everything())\n\nmedals_gdp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,463 × 14\n    Year Season ISO3c country      perc_Gold_gdp perc_Silver_gdp perc_Bronze_gdp\n   <dbl> <chr>  <chr> <chr>                <dbl>           <dbl>           <dbl>\n 1  2016 Summer USA   United Stat…      0.000797        0.000643        0.000561\n 2  2016 Summer GBR   Great Brita…      0.00327         0.00280         0.00176 \n 3  2016 Summer CHN   China             0.000754        0.000524        0.000643\n 4  2016 Summer RUS   Russia            0.00485         0.00435         0.00435 \n 5  2016 Summer DEU   Germany           0.00160         0.000942        0.00120 \n 6  2016 Summer JPN   Japan             0.000781        0.000522        0.00117 \n 7  2016 Summer FRA   France            0.00132         0.00238         0.00157 \n 8  2016 Summer KOR   South Korea       0.00195         0.000654        0.00167 \n 9  2016 Summer ITA   Italy             0.00139         0.00209         0.00118 \n10  2016 Summer AUS   Australia         0.00216         0.00298         0.00230 \n# ℹ 2,453 more rows\n# ℹ 7 more variables: perc_Gold <dbl>, perc_Silver <dbl>, perc_Bronze <dbl>,\n#   perc_Total <dbl>, indicator_name <chr>, gdp <dbl>, gdp_bil <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nflag_db <- readr::read_csv(\"data/Country_Flags.csv\", show_col_type = FALSE) %>% \n  #Convert country names into 3-letter country codes\n  mutate(Code_raw = countrycode(sourcevar = Country, origin = \"country.name\", destination = \"iso3c\", warn = FALSE),\n         ## There are a few cases that need to be specified manually\n         Code = case_when(Country == \"Soviet Union\" ~ \"SUN\",\n                          Country == \"East Germany\" ~ \"DDR\",\n                          Country == \"Yugoslavia\" ~ \"YUG\",\n                          TRUE ~ Code_raw)) %>% \n  select(Code, flag_URL = ImageURL)\n\ngames_names <- readr::read_csv(\"data/games_names.csv\", show_col_type = FALSE)\n\nplot_data <- medals_gdp |>\n  left_join(medals_wide |> select(Year, ISO3c, total_medals),\n            by = c(\"Year\", \"ISO3c\")) |> \n  filter(Year >= 1996 & total_medals >= 5) |> \n  arrange(desc(perc_Gold_gdp), desc(perc_Silver_gdp), desc(perc_Bronze_gdp)) |> \n  mutate(rank = 1:n()) |>\n  filter(rank <= 10 | (Year == 2008 & ISO3c == \"CHN\") | (Year == 1996 & ISO3c == \"USA\")) |> \n  left_join(games_names, by = \"Year\") |> \n  left_join(flag_db, by = c(\"ISO3c\" = \"Code\")) |> \n  select(rank, Game, flag_URL, country, perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil)\n\n## Create dynamic palettes to colour Gold, Silver, and Bronze columns\nperc_palette_Gold <- col_numeric(c(\"grey99\", \"#fcc861\"), domain = c(0, max(plot_data$perc_Gold_gdp)), alpha = 0.75)\nperc_palette_Silver <- col_numeric(c(\"grey99\", \"#e5e5e5\"), domain = c(0, max(plot_data$perc_Silver_gdp)), alpha = 0.75)\nperc_palette_Bronze <- col_numeric(c(\"grey99\", \"#dcb386\"), domain = c(0, max(plot_data$perc_Bronze_gdp)), alpha = 0.75)\n\nplot_data |> \n  gt() |> \n  cols_label(rank = \"\",\n             Game = \"Games\",\n             country = \"Country\",\n             perc_Gold_gdp = md(\"Gold<br>(%/$GDP)\"),\n             perc_Silver_gdp = md(\"Silver<br>(%/$GDP)\"),\n             perc_Bronze_gdp = md(\"Bronze<br>(%/$GDP)\"),\n             gdp_bil = md(\"GDP<br>(Billion $USD)\")) %>% \n  tab_header(title = md(\"Olympic performance (% relative to GDP)\"),\n             subtitle = md(\"Best national performances (1996 - 2016)<br>Considering countries that won at least 5 medals\")) %>% \n  tab_source_note(source_note = md(\"Olympic data: www.sports-reference.com<br>GDP data: World Bank Group\")) %>% \n  tab_style(\n    locations = cells_column_labels(columns = everything()),\n    style     = list(\n      cell_borders(sides = \"bottom\", weight = px(3)),\n      cell_text(weight = \"bold\")\n    )\n  ) %>% \n  tab_style(\n    locations = cells_title(groups = \"title\"),\n    style     = list(\n      cell_text(weight = \"bold\", size = 24)\n    )\n  ) %>% \n  data_color(columns = c(perc_Gold_gdp),\n             fn = perc_palette_Gold) %>%\n  data_color(columns = c(perc_Silver_gdp),\n             fn = perc_palette_Silver) %>%\n  data_color(columns = c(perc_Bronze_gdp),\n             fn = perc_palette_Bronze) %>%\n  fmt_number(columns = c(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil),\n             decimals = 3) %>%\n  fmt_number(columns = c(gdp_bil), pattern = \"${x}\") %>%\n  opt_all_caps() %>% \n  opt_table_font(\n    font = list(\n      google_font(\"Chivo\"),\n      default_fonts()\n    )\n  ) %>%\n  cols_width(rank ~ px(40),\n             c(country, Game) ~ px(125),\n             c(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp) ~ px(80),\n             gdp_bil ~ px(110)) %>% \n  tab_options(\n    column_labels.border.top.width = px(3),\n    column_labels.border.top.color = \"transparent\",\n    table.border.top.color = \"transparent\",\n    table.border.bottom.color = \"transparent\",\n    data_row.padding = px(3),\n    source_notes.font.size = 12,\n    heading.align = \"left\") |> \n  gt::text_transform(\n    #Apply a function to a column\n    locations = cells_body(c(flag_URL)),\n    fn = function(x) {\n      #Return an image of set dimensions\n      web_image(\n        url = x,\n        height = 12\n      )\n    }\n  ) %>% \n  #Hide column header flag_URL and reduce width\n  cols_width(c(flag_URL) ~ px(30)) %>% \n  cols_label(flag_URL = \"\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mzdgpyuumg\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>@import url(\"https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\n#mzdgpyuumg table {\n  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mzdgpyuumg thead, #mzdgpyuumg tbody, #mzdgpyuumg tfoot, #mzdgpyuumg tr, #mzdgpyuumg td, #mzdgpyuumg th {\n  border-style: none;\n}\n\n#mzdgpyuumg p {\n  margin: 0;\n  padding: 0;\n}\n\n#mzdgpyuumg .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: rgba(255, 255, 255, 0);\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mzdgpyuumg .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mzdgpyuumg .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mzdgpyuumg .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 3px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mzdgpyuumg .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mzdgpyuumg .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mzdgpyuumg .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mzdgpyuumg .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mzdgpyuumg .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mzdgpyuumg .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mzdgpyuumg .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mzdgpyuumg .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mzdgpyuumg .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mzdgpyuumg .gt_row {\n  padding-top: 3px;\n  padding-bottom: 3px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mzdgpyuumg .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mzdgpyuumg .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mzdgpyuumg .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mzdgpyuumg .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mzdgpyuumg .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mzdgpyuumg .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mzdgpyuumg .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mzdgpyuumg .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mzdgpyuumg .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mzdgpyuumg .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mzdgpyuumg .gt_sourcenote {\n  font-size: 12px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mzdgpyuumg .gt_left {\n  text-align: left;\n}\n\n#mzdgpyuumg .gt_center {\n  text-align: center;\n}\n\n#mzdgpyuumg .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mzdgpyuumg .gt_font_normal {\n  font-weight: normal;\n}\n\n#mzdgpyuumg .gt_font_bold {\n  font-weight: bold;\n}\n\n#mzdgpyuumg .gt_font_italic {\n  font-style: italic;\n}\n\n#mzdgpyuumg .gt_super {\n  font-size: 65%;\n}\n\n#mzdgpyuumg .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mzdgpyuumg .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mzdgpyuumg .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mzdgpyuumg .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mzdgpyuumg .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mzdgpyuumg .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mzdgpyuumg .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;; width: 0px\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:40px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:30px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:80px;\"/>\n    <col style=\"width:80px;\"/>\n    <col style=\"width:80px;\"/>\n    <col style=\"width:110px;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_title gt_font_normal\" style=\"font-size: 24; font-weight: bold;\">Olympic performance (% relative to GDP)</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Best national performances (1996 - 2016)<br>Considering countries that won at least 5 medals</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Games\">Games</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Country\">Country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Gold&lt;br&gt;(%/$GDP)\">Gold<br>(%/$GDP)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Silver&lt;br&gt;(%/$GDP)\">Silver<br>(%/$GDP)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Bronze&lt;br&gt;(%/$GDP)\">Bronze<br>(%/$GDP)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"GDP&lt;br&gt;(Billion $USD)\">GDP<br>(Billion $USD)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/7/71/Flag_of_Ethiopia.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Ethiopia</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCC861; color: #000000;\">0.162</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F8F8F8; color: #000000;\">0.040</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F1DDC9; color: #000000;\">0.112</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$8.24</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Rio 2016</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Jamaica</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FECF78; color: #000000;\">0.139</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F4F4F4; color: #000000;\">0.070</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F8F1EA; color: #000000;\">0.039</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$14.08</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/b/bd/Flag_of_Cuba.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Cuba</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFD17E; color: #000000;\">0.133</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">0.117</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F1DECB; color: #000000;\">0.108</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$25.02</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Bulgaria.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Bulgaria</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFD384; color: #000000;\">0.126</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EBEBEB; color: #000000;\">0.151</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F8EFE7; color: #000000;\">0.046</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$13.25</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Jamaica</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFD58A; color: #000000;\">0.121</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F7F7F7; color: #000000;\">0.048</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F8F0E9; color: #000000;\">0.041</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$13.71</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/b/bd/Flag_of_Cuba.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Cuba</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFD58A; color: #000000;\">0.120</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">0.120</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F5E8DC; color: #000000;\">0.070</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$30.57</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/7/73/Flag_of_Romania.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Romania</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFDC9E; color: #000000;\">0.099</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F6F6F6; color: #000000;\">0.054</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F5E7DA; color: #000000;\">0.074</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$37.25</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Bulgaria.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Bulgaria</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFDFA7; color: #000000;\">0.090</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #E5E5E5; color: #000000;\">0.209</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EED6BE; color: #000000;\">0.137</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$12.29</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">London 2012</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Jamaica</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFDFA7; color: #000000;\">0.089</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F2F2F2; color: #000000;\">0.089</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F5E7D9; color: #000000;\">0.076</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$14.81</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/8/85/Flag_of_Belarus.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Belarus</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFE2B1; color: #000000;\">0.079</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F3F3F3; color: #000000;\">0.079</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #DCB386; color: #000000;\">0.265</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$12.74</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">124</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">China</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FDFBF8; color: #000000;\">0.004</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.002</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFB; color: #000000;\">0.002</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$4,594.34</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">162</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFBFA; color: #000000;\">0.002</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.001</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.001</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$8,073.12</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"8\">Olympic data: <a href=\"http://www.sports-reference.com\">www.sports-reference.com</a><br>GDP data: World Bank Group</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nWe finally get a picture of the real Olympic winners! Countries that have been able to achieve sporting success despite having orders of magnitude less money to invest into expensive sporting facilities or training regimes.\n\n::: {.callout-note}\nThis table shows the top 10 countries using our new % medal/$GDP metric, but I've filtered it down to show only countries that won 5 or more medals. This hopefully focuses on countries with a quality Olympic *team* rather than just one individual star. You can see the full (unfiltered) table below.\n:::\n\n</br>\n\n## The Conclusion: Always think twice about statistics\n\n---\n\nHeadlines about record breaking medal tallies may seem catchy, but this is often just a consequence of the increasing number of sports and events being added to the Olympics (e.g. skateboarding, climbing). Even when countries do break new medal records (accounting for medal inflation!) a lot of these wins are only possible with hefty government investment which isn't available in most places. Next time you're looking at the Olympic medal tally, maybe scroll down a bit to spot those countries that are really punching above their weight.\n\nNext week, we can see what our Olympic assessment method can tell us about the results of Paris 2024.\n\n</br>\n</br>\n\n---\n\n## Appendix: Top ranked countries without filtering\n\n---\n\nThis table shows the top ranking countries based on % medals/$GDP, but including countries with small medals hauls (<5). We see a few new appearances but Jamaica, Ethiopia, Cuba, and Bulgaria still feature in the top 10.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nflag_db <- readr::read_csv(\"data/Country_Flags.csv\", show_col_type = FALSE) %>% \n  #Convert country names into 3-letter country codes\n  mutate(Code_raw = countrycode(sourcevar = Country, origin = \"country.name\", destination = \"iso3c\", warn = FALSE),\n         ## There are a few cases that need to be specified manually\n         Code = case_when(Country == \"Soviet Union\" ~ \"SUN\",\n                          Country == \"East Germany\" ~ \"DDR\",\n                          Country == \"Yugoslavia\" ~ \"YUG\",\n                          TRUE ~ Code_raw)) %>% \n  select(Code, flag_URL = ImageURL)\n\ngames_names <- readr::read_csv(\"data/games_names.csv\", show_col_type = FALSE)\n\nplot_data <- medals_gdp |>\n  left_join(medals_wide |> select(Year, ISO3c, total_medals),\n            by = c(\"Year\", \"ISO3c\")) |> \n  filter(Year >= 1996) |> \n  arrange(desc(perc_Gold_gdp), desc(perc_Silver_gdp), desc(perc_Bronze_gdp)) |> \n  mutate(rank = 1:n()) |>\n  filter(rank <= 10 | (Year == 2008 & ISO3c == \"CHN\") | (Year == 1996 & ISO3c == \"USA\")) |> \n  left_join(games_names, by = \"Year\") |> \n  left_join(flag_db, by = c(\"ISO3c\" = \"Code\")) |> \n  select(rank, Game, flag_URL, country, perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil)\n\n## Create dynamic palettes to colour Gold, Silver, and Bronze columns\nperc_palette_Gold <- col_numeric(c(\"grey99\", \"#fcc861\"), domain = c(0, max(plot_data$perc_Gold_gdp)), alpha = 0.75)\nperc_palette_Silver <- col_numeric(c(\"grey99\", \"#e5e5e5\"), domain = c(0, max(plot_data$perc_Silver_gdp)), alpha = 0.75)\nperc_palette_Bronze <- col_numeric(c(\"grey99\", \"#dcb386\"), domain = c(0, max(plot_data$perc_Bronze_gdp)), alpha = 0.75)\n\nplot_data |> \n  gt() |> \n  cols_label(rank = \"\",\n             Game = \"Games\",\n             country = \"Country\",\n             perc_Gold_gdp = md(\"Gold<br>(%/$GDP)\"),\n             perc_Silver_gdp = md(\"Silver<br>(%/$GDP)\"),\n             perc_Bronze_gdp = md(\"Bronze<br>(%/$GDP)\"),\n             gdp_bil = md(\"GDP<br>(Billion $USD)\")) %>% \n  tab_header(title = md(\"Olympic performance (% relative to GDP)\"),\n             subtitle = md(\"Best national performances (1996 - 2016)\")) %>% \n  tab_source_note(source_note = md(\"Olympic data: www.sports-reference.com<br>GDP data: World Bank Group\")) %>% \n  tab_style(\n    locations = cells_column_labels(columns = everything()),\n    style     = list(\n      cell_borders(sides = \"bottom\", weight = px(3)),\n      cell_text(weight = \"bold\")\n    )\n  ) %>% \n  tab_style(\n    locations = cells_title(groups = \"title\"),\n    style     = list(\n      cell_text(weight = \"bold\", size = 24)\n    )\n  ) %>% \n  data_color(columns = c(perc_Gold_gdp),\n             fn = perc_palette_Gold) %>%\n  data_color(columns = c(perc_Silver_gdp),\n             fn = perc_palette_Silver) %>%\n  data_color(columns = c(perc_Bronze_gdp),\n             fn = perc_palette_Bronze) %>%\n  fmt_number(columns = c(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil),\n             decimals = 3) %>%\n  fmt_number(columns = c(gdp_bil), pattern = \"${x}\") %>%\n  opt_all_caps() %>% \n  opt_table_font(\n    font = list(\n      google_font(\"Chivo\"),\n      default_fonts()\n    )\n  ) %>%\n  cols_width(rank ~ px(40),\n             c(country, Game) ~ px(125),\n             c(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp) ~ px(80),\n             gdp_bil ~ px(110)) %>% \n  tab_options(\n    column_labels.border.top.width = px(3),\n    column_labels.border.top.color = \"transparent\",\n    table.border.top.color = \"transparent\",\n    table.border.bottom.color = \"transparent\",\n    data_row.padding = px(3),\n    source_notes.font.size = 12,\n    heading.align = \"left\") |> \n  gt::text_transform(\n    #Apply a function to a column\n    locations = cells_body(c(flag_URL)),\n    fn = function(x) {\n      #Return an image of set dimensions\n      web_image(\n        url = x,\n        height = 12\n      )\n    }\n  ) %>% \n  #Hide column header flag_URL and reduce width\n  cols_width(c(flag_URL) ~ px(30)) %>% \n  cols_label(flag_URL = \"\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fwbsrklflp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>@import url(\"https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\");\n#fwbsrklflp table {\n  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fwbsrklflp thead, #fwbsrklflp tbody, #fwbsrklflp tfoot, #fwbsrklflp tr, #fwbsrklflp td, #fwbsrklflp th {\n  border-style: none;\n}\n\n#fwbsrklflp p {\n  margin: 0;\n  padding: 0;\n}\n\n#fwbsrklflp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: rgba(255, 255, 255, 0);\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fwbsrklflp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fwbsrklflp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fwbsrklflp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: left;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 3px;\n  border-top-color: rgba(255, 255, 255, 0);\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fwbsrklflp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fwbsrklflp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fwbsrklflp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fwbsrklflp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fwbsrklflp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fwbsrklflp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fwbsrklflp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fwbsrklflp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fwbsrklflp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fwbsrklflp .gt_row {\n  padding-top: 3px;\n  padding-bottom: 3px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fwbsrklflp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 80%;\n  font-weight: bolder;\n  text-transform: uppercase;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbsrklflp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fwbsrklflp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fwbsrklflp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fwbsrklflp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbsrklflp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fwbsrklflp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbsrklflp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fwbsrklflp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbsrklflp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbsrklflp .gt_sourcenote {\n  font-size: 12px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbsrklflp .gt_left {\n  text-align: left;\n}\n\n#fwbsrklflp .gt_center {\n  text-align: center;\n}\n\n#fwbsrklflp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fwbsrklflp .gt_font_normal {\n  font-weight: normal;\n}\n\n#fwbsrklflp .gt_font_bold {\n  font-weight: bold;\n}\n\n#fwbsrklflp .gt_font_italic {\n  font-style: italic;\n}\n\n#fwbsrklflp .gt_super {\n  font-size: 65%;\n}\n\n#fwbsrklflp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fwbsrklflp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fwbsrklflp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fwbsrklflp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fwbsrklflp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fwbsrklflp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fwbsrklflp .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" style=\"table-layout: fixed;; width: 0px\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <colgroup>\n    <col style=\"width:40px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:30px;\"/>\n    <col style=\"width:125px;\"/>\n    <col style=\"width:80px;\"/>\n    <col style=\"width:80px;\"/>\n    <col style=\"width:80px;\"/>\n    <col style=\"width:110px;\"/>\n  </colgroup>\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_title gt_font_normal\" style=\"font-size: 24; font-weight: bold;\">Olympic performance (% relative to GDP)</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"8\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Best national performances (1996 - 2016)</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Games\">Games</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Country\">Country</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Gold&lt;br&gt;(%/$GDP)\">Gold<br>(%/$GDP)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Silver&lt;br&gt;(%/$GDP)\">Silver<br>(%/$GDP)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"Bronze&lt;br&gt;(%/$GDP)\">Bronze<br>(%/$GDP)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" style=\"border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;\" scope=\"col\" id=\"GDP&lt;br&gt;(Billion $USD)\">GDP<br>(Billion $USD)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">1</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/5/50/Flag_of_Burundi.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Burundi</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCC861; color: #000000;\">0.425</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$0.87</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">2</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">London 2012</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/b/bc/Flag_of_Grenada.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Grenada</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCC965; color: #000000;\">0.414</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$0.80</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">3</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/2/2f/Flag_of_Armenia.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Armenia</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFDFA8; color: #000000;\">0.231</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #E5E5E5; color: #000000;\">0.229</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$1.60</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">4</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/7/71/Flag_of_Ethiopia.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Ethiopia</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFE8C1; color: #000000;\">0.162</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F8F8F8; color: #000000;\">0.040</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #DCB386; color: #000000;\">0.112</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$8.24</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">5</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Rio 2016</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Jamaica</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFEBCA; color: #000000;\">0.139</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F5F5F5; color: #000000;\">0.070</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F3E2D1; color: #000000;\">0.039</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$14.08</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">6</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/b/bd/Flag_of_Cuba.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Cuba</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFEBCC; color: #000000;\">0.133</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F0F0F0; color: #000000;\">0.117</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #DDB68A; color: #000000;\">0.108</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$25.02</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">7</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Athens 2004</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0f/Flag_of_Georgia.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Georgia</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFECCD; color: #000000;\">0.130</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EFEFEF; color: #000000;\">0.130</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$5.13</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">8</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/d/dd/Flag_of_Azerbaijan.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Azerbaijan</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFECCE; color: #000000;\">0.127</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.000</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EDD5BD; color: #000000;\">0.058</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$5.27</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">9</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Sydney 2000</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Bulgaria.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Bulgaria</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFECCE; color: #000000;\">0.126</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #EDEDED; color: #000000;\">0.151</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F1DDCA; color: #000000;\">0.046</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$13.25</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">10</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">Jamaica</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FFEDD0; color: #000000;\">0.121</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F7F7F7; color: #000000;\">0.048</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #F2E0CF; color: #000000;\">0.041</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$13.71</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">184</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Beijing 2008</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">China</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFB; color: #000000;\">0.004</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.002</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFBFA; color: #000000;\">0.002</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$4,594.34</td></tr>\n    <tr><td headers=\"rank\" class=\"gt_row gt_right\">234</td>\n<td headers=\"Game\" class=\"gt_row gt_left\">Atlanta 1996</td>\n<td headers=\"flag_URL\" class=\"gt_row gt_left\"><img src=\"https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg\" style=\"height:12px;\"></td>\n<td headers=\"country\" class=\"gt_row gt_left\">United States</td>\n<td headers=\"perc_Gold_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFB; color: #000000;\">0.002</td>\n<td headers=\"perc_Silver_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFCFC; color: #000000;\">0.001</td>\n<td headers=\"perc_Bronze_gdp\" class=\"gt_row gt_right\" style=\"background-color: #FCFBFB; color: #000000;\">0.001</td>\n<td headers=\"gdp_bil\" class=\"gt_row gt_right\">$8,073.12</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"8\">Olympic data: <a href=\"http://www.sports-reference.com\">www.sports-reference.com</a><br>GDP data: World Bank Group</td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}