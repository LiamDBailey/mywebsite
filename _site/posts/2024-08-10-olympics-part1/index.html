<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.330">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liam D. Bailey">
<meta name="dcterms.date" content="2024-08-10">
<meta name="description" content="The top countries might not be who you think">

<title>Dr.&nbsp;Liam D. Bailey</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../inst/css/base.css">
<link rel="stylesheet" href="../../inst/css/blogpage.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Dr.&nbsp;Liam D. Bailey</span>
    </a>
  </div>
          <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../dataviz.html"> 
<span class="menu-text">dataviz</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assets/LiamDBailey_CV.pdf"> 
<span class="menu-text">resume</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/LiamDBailey" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ldbailey255" target="_blank"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          <div class="quarto-navbar-tools">
</div>
            <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Who really wins the Olympics?</h1>
                  <div>
        <div class="description">
          The top countries might not be who you think
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Data viz</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Liam D. Bailey </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 10, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-is-there-an-easy-answer" id="toc-introduction-is-there-an-easy-answer" class="nav-link active" data-scroll-target="#introduction-is-there-an-easy-answer">Introduction: Is there an easy answer?</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The data</a></li>
  <li><a href="#the-basics-clean-the-data-and-add-some-context" id="toc-the-basics-clean-the-data-and-add-some-context" class="nav-link" data-scroll-target="#the-basics-clean-the-data-and-add-some-context">The basics: Clean the data and add some context</a></li>
  <li><a href="#problem-1-the-problem-of-medal-inflation" id="toc-problem-1-the-problem-of-medal-inflation" class="nav-link" data-scroll-target="#problem-1-the-problem-of-medal-inflation">Problem 1: The Problem of (medal) Inflation</a></li>
  <li><a href="#problem-2-the-problem-of-politics-and-pandemics" id="toc-problem-2-the-problem-of-politics-and-pandemics" class="nav-link" data-scroll-target="#problem-2-the-problem-of-politics-and-pandemics">Problem 2: The Problem of Politics (and Pandemics)</a></li>
  <li><a href="#problem-3-the-problem-of-money" id="toc-problem-3-the-problem-of-money" class="nav-link" data-scroll-target="#problem-3-the-problem-of-money">Problem 3: The Problem of Money</a></li>
  <li><a href="#the-conclusion-always-think-twice-about-statistics" id="toc-the-conclusion-always-think-twice-about-statistics" class="nav-link" data-scroll-target="#the-conclusion-always-think-twice-about-statistics">The Conclusion: Always think twice about statistics</a></li>
  <li><a href="#appendix-top-ranked-countries-without-filtering" id="toc-appendix-top-ranked-countries-without-filtering" class="nav-link" data-scroll-target="#appendix-top-ranked-countries-without-filtering">Appendix: Top ranked countries without filtering</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction-is-there-an-easy-answer" class="level2">
<h2 data-anchor-id="introduction-is-there-an-easy-answer">Introduction: Is there an easy answer?</h2>
<hr>
<p>These type of record breaking headlines are a mainstay of Olympic coverage, but does the medal tally actually give us a true picture of a nation’s Olympic achievements? Is this data suitable to compare countries over time? Although I don’t have the physical prowess to actually <em>participate</em> in the Olympics, maybe I can still analyse it. Let’s dig into the Olympic data bank and search for answers…</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.theguardian.com/sport/article/2024/aug/08/paris-olympics-2024-australia-gold-medal-tally-record-matt-wearn-keegan-palmer-nina-kennedy"><img src="./data/Aus_medals.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Australia’s best medal tally (Guardian)</figcaption>
</figure>
</div>
<p><br></p>
</section>
<section id="the-data" class="level2">
<h2 data-anchor-id="the-data">The data</h2>
<hr>
<p>For our source of Olympic knowledge we use the Kaggle dataset <a href="https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results">“120 years of Olympic history: athletes and results”</a> scraped by rgriffin from http://www.sports-reference.com/. This data provides us with a wealth of knowledge on the athletes participating in the Olympics from Athens 1896 until Rio 2016.</p>
<p><br></p>
</section>
<section id="the-basics-clean-the-data-and-add-some-context" class="level2">
<h2 data-anchor-id="the-basics-clean-the-data-and-add-some-context">The basics: Clean the data and add some context</h2>
<hr>
<p>Let’s load all the required packages. For data wrangling we have a bunch of packages from the <code>tidyverse</code>: <code>tidyr</code>, <code>stringr</code>, <code>readr</code>, and <code>dplyr</code>. We also bring in the packages <code>lay</code>, and <code>janitor</code> which help with wrangling. Next we bring in <code>countrycode</code>, which allows us to more easily switch between IOC country codes and the ISO3c standard (yes they are different!). Finally, for data visualisation, we have <code>ggplot2</code>, <code>shadowtext</code>, <code>scales</code> and <code>gt</code> (for tables).</p>
<p>That’s quite a few packages and I’ll try to make it clear where each package is needed in the code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data wrangling</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lay)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Dealing with country codes</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shadowtext)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s get started on our Olympic investigation. The first thing to note is that we have data on <em>all</em> athletes, even those that did not win a medal. We also have data on each individual athlete within a team sport (e.g.&nbsp;basketball). This is super interesting data, but if we want to know the best performing countries, we’ll need to adapt this data a bit to show <em>national</em> medal tallies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>athletes <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"./data/athlete_events.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>athletes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 271,116 × 15
      ID Name     Sex     Age Height Weight Team  NOC   Games  Year Season City 
   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;
 1     1 A Dijia… M        24    180     80 China CHN   1992…  1992 Summer Barc…
 2     2 A Lamusi M        23    170     60 China CHN   2012…  2012 Summer Lond…
 3     3 Gunnar … M        24     NA     NA Denm… DEN   1920…  1920 Summer Antw…
 4     4 Edgar L… M        34     NA     NA Denm… DEN   1900…  1900 Summer Paris
 5     5 Christi… F        21    185     82 Neth… NED   1988…  1988 Winter Calg…
 6     5 Christi… F        21    185     82 Neth… NED   1988…  1988 Winter Calg…
 7     5 Christi… F        25    185     82 Neth… NED   1992…  1992 Winter Albe…
 8     5 Christi… F        25    185     82 Neth… NED   1992…  1992 Winter Albe…
 9     5 Christi… F        27    185     82 Neth… NED   1994…  1994 Winter Lill…
10     5 Christi… F        27    185     82 Neth… NED   1994…  1994 Winter Lill…
# ℹ 271,106 more rows
# ℹ 3 more variables: Sport &lt;chr&gt;, Event &lt;chr&gt;, Medal &lt;chr&gt;</code></pre>
</div>
</div>
<p>For simplicity, let’s just focus on summer Olympics and stick with post-War Olympics (1948 onwards). In our first step of data wrangling, we adjust the data so that we count the number of each medal type for each country at each games. At this stage, data are still in long format.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because most other datasets will use ISO3c codes as country identifiers, I already substitute IOC codes to ISO3c at this early stage.</p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>athletes_clean <span class="ot">&lt;-</span> athletes <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Focus only on Summer Olympics since London (1948)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Season <span class="sc">==</span> <span class="st">"Summer"</span> <span class="sc">&amp;</span> Year <span class="sc">&gt;=</span> <span class="dv">1948</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## For simplicity, let's classify NA as medal "None"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Keeping None ensures we don't exclude countries that participated in the Olympics </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## but didn't win any medals</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Medal =</span> <span class="fu">replace_na</span>(Medal, <span class="st">"None"</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="do">## </span><span class="al">NOTE</span><span class="do">: There are some country names that have "-1" in the name</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="do">## We fix these typos</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Team =</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(Team, <span class="at">pattern =</span> <span class="st">"-[0-9]*"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="do">## Some other known typos</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Team =</span> <span class="fu">case_when</span>(Team <span class="sc">==</span> <span class="st">"Nadine"</span> <span class="sc">~</span> <span class="st">"Netherlands"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"Don Schufro"</span> <span class="sc">~</span> <span class="st">"Denmark"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"Rush VII"</span> <span class="sc">~</span> <span class="st">"Sweden"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Gem"</span>, <span class="st">"Gem IV"</span>, <span class="st">"Yeoman"</span>) <span class="sc">~</span> <span class="st">"Bahamas"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"Tango"</span> <span class="sc">~</span> <span class="st">"Argentina"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"Nirefs"</span> <span class="sc">~</span> <span class="st">"Greece"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Pan"</span>, <span class="st">"Sirene"</span>, <span class="st">"Encore"</span>) <span class="sc">~</span> <span class="st">"Norway"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Symphony"</span>, <span class="st">"Espadarte"</span>, <span class="st">"Ma'Lindo"</span>) <span class="sc">~</span> <span class="st">"Portugal"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"June Climene"</span> <span class="sc">~</span> <span class="st">"Singapore"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"Kurush II"</span> <span class="sc">~</span> <span class="st">"Cuba"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Pam"</span>, <span class="st">"Bermudes"</span>) <span class="sc">~</span> <span class="st">"Bermuda"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                          Team <span class="sc">==</span> <span class="st">"Hirondelle"</span> <span class="sc">~</span> <span class="st">"Monaco"</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Team)) <span class="sc">|&gt;</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## We're much more familiar with ISO codes (and need them to join other data below)</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">## So we'll take this opportunity to switch to ISO3c codes</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Convert IOC country codes to ISO3C</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="do">## In most cases, we can convert straight from IOC codes to ISO3c</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">ISO3c_NOC =</span> countrycode<span class="sc">::</span><span class="fu">countrycode</span>(NOC, <span class="at">origin =</span> <span class="st">"ioc"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>),</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="do">## In some cases, the IOC codes are not recognised so we try using country names     </span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">ISO3c_name =</span> <span class="fu">countrycode</span>(Team, <span class="at">origin =</span> <span class="st">"country.name"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>),</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="do">## There are a few cases where the countrycode package struggles and we add codes manually</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ISO3c =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>      <span class="do">## countrycode treats Soviet Union and Russia as the same</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>      <span class="do">## We want to keep these separate</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      NOC <span class="sc">==</span> <span class="st">"URS"</span> <span class="sc">~</span> <span class="st">"SUN"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Use direct translation from IOC codes where available</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span><span class="fu">is.na</span>(ISO3c_NOC) <span class="sc">~</span> ISO3c_NOC,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Otherwise, use estimates based on the English name (less reliable)</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(ISO3c_NOC) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ISO3c_name) <span class="sc">~</span> ISO3c_name,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>      <span class="do">## In a few specific cases (Cold War era states), we manually specify the country code</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="at">x =</span> Team, <span class="at">pattern =</span> <span class="st">"Czechoslovakia"</span>) <span class="sc">~</span> <span class="st">"CSK"</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="at">x =</span> Team, <span class="at">pattern =</span> <span class="st">"East Germany"</span>) <span class="sc">~</span> <span class="st">"DDR"</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Rhodesia converted to Zimbabwe</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      NOC <span class="sc">==</span> <span class="st">"RHO"</span> <span class="sc">~</span> <span class="st">"ZWE"</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="at">x =</span> Team, <span class="at">pattern =</span> <span class="st">"Netherlands Antilles"</span>) <span class="sc">~</span> <span class="st">"ANT"</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="at">x =</span> Team, <span class="at">pattern =</span> <span class="st">"Serbia and Montenegro"</span>) <span class="sc">~</span> <span class="st">"SCG"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="at">x =</span> Team, <span class="at">pattern =</span> <span class="st">"Kosovo"</span>) <span class="sc">~</span> <span class="st">"XKX"</span>, <span class="do">## Based on WorldBank</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If we can't find a ISO3c match we revert back to the IOC codes</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>      <span class="do">## This includes athletes competing as refugees or individuals</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> NOC)) <span class="sc">|&gt;</span> </span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  <span class="do">## When medals are won by a *team* in an event we only want to count the medal once</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Season, ISO3c, Event, Medal) <span class="sc">|&gt;</span> </span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>medals_long <span class="ot">&lt;-</span> athletes_clean <span class="sc">|&gt;</span> </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Count the number of each medal won by each country at each olympics</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Season, ISO3c, Medal) <span class="sc">|&gt;</span> </span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">country =</span> <span class="fu">first</span>(Team),</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>medals_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,691 × 6
    Year Season ISO3c Medal      n country    
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;      
 1  1948 Summer AFG   None       2 Afghanistan
 2  1948 Summer ARG   Bronze     1 Argentina  
 3  1948 Summer ARG   Gold       3 Argentina  
 4  1948 Summer ARG   None      96 Argentina  
 5  1948 Summer ARG   Silver     3 Argentina  
 6  1948 Summer AUS   Bronze     5 Australia  
 7  1948 Summer AUS   Gold       2 Australia  
 8  1948 Summer AUS   None      43 Australia  
 9  1948 Summer AUS   Silver     6 Australia  
10  1948 Summer AUT   Bronze     4 Austria    
# ℹ 4,681 more rows</code></pre>
</div>
</div>
<p>This is a good start, but we would be better served by data in wide format with one column for each medal type. This is how we’re more accustomed to seeing Olympic data.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>medals_wide <span class="ot">&lt;-</span> medals_long <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Pivot wider to have column for number of medals won for each type</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Medal, <span class="at">values_from =</span> n) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Some countries won't have any data for a medal type (i.e. they won none).</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Replace these NAs with 0</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(None, Gold, Silver, Bronze), \(x) <span class="fu">replace_na</span>(x, <span class="dv">0</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Order columns more logically</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Season, ISO3c, country, Gold, Silver, Bronze) <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Arrange to show best performing country at each games using traditional ranking</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Year), Season, <span class="fu">desc</span>(Gold), <span class="fu">desc</span>(Silver), <span class="fu">desc</span>(Bronze)) <span class="sc">|&gt;</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Count the total number of medals</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_medals =</span> <span class="fu">lay</span>(<span class="fu">pick</span>(<span class="fu">c</span>(Gold, Silver, Bronze)), \(x) <span class="fu">sum</span>(x)))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>medals_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,463 × 8
    Year Season ISO3c country        Gold Silver Bronze total_medals
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;int&gt;  &lt;int&gt;  &lt;int&gt;        &lt;int&gt;
 1  2016 Summer USA   United States    46     37     38          121
 2  2016 Summer GBR   Great Britain    27     23     17           67
 3  2016 Summer CHN   China            26     18     26           70
 4  2016 Summer RUS   Russia           19     17     20           56
 5  2016 Summer DEU   Germany          17     10     15           42
 6  2016 Summer JPN   Japan            12      8     21           41
 7  2016 Summer FRA   France           10     18     14           42
 8  2016 Summer KOR   South Korea       9      3      9           21
 9  2016 Summer ITA   Italy             8     12      8           28
10  2016 Summer AUS   Australia         8     11     10           29
# ℹ 2,453 more rows</code></pre>
</div>
</div>
<p>With this data we can now look at the best Olympic performances since 1948. The table below is generated by <code>gt</code>. See <a href="https://liamdbailey.com/posts/2020-11-27-making-beautiful-tables-with-gt/">my previous blog post</a> for more detail to understand how such tables are created.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find out the interesting story of the Unified Team at the 1992 Olympics <a href="https://en.wikipedia.org/wiki/Unified_Team_at_the_Olympics">here</a></p>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>flag_db <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/Country_Flags.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Convert country names into 3-letter country codes</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Code_raw =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Country, <span class="at">origin =</span> <span class="st">"country.name"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="do">## There are a few cases that need to be specified manually</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Code =</span> <span class="fu">case_when</span>(Country <span class="sc">==</span> <span class="st">"Soviet Union"</span> <span class="sc">~</span> <span class="st">"SUN"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"East Germany"</span> <span class="sc">~</span> <span class="st">"DDR"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"Yugoslavia"</span> <span class="sc">~</span> <span class="st">"YUG"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"Olympics"</span> <span class="sc">~</span> <span class="st">"EUN"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Code_raw)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Code, <span class="at">flag_URL =</span> ImageURL)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Data to convert Years into a convenient games name (e.g. Rio 2016)</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>games_names <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/games_names.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Find the top 10 medal tallies of all time</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> medals_wide <span class="sc">|&gt;</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Gold), <span class="fu">desc</span>(Silver), <span class="fu">desc</span>(Bronze)) <span class="sc">|&gt;</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Join in info on the name of each game and the flag image URLS</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(games_names, <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flag_db, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ISO3c"</span> <span class="ot">=</span> <span class="st">"Code"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, Game, flag_URL, country, Gold, Silver, Bronze) <span class="sc">|&gt;</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_medals =</span> <span class="fu">lay</span>(<span class="fu">pick</span>(<span class="fu">c</span>(Gold, Silver, Bronze)), sum))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Create dynamic palettes to colour Gold, Silver, and Bronze columns</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>perc_palette_Gold <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#fcc861"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>Gold)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>perc_palette_Silver <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#e5e5e5"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>Silver)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>perc_palette_Bronze <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#dcb386"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>Bronze)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Create the gt table</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plot_data <span class="sc">|&gt;</span> </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rank =</span> <span class="st">""</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">Game =</span> <span class="st">"Games"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">country =</span> <span class="st">"Country"</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">Gold =</span> <span class="st">"Gold"</span>,</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">Silver =</span> <span class="st">"Silver"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">Bronze =</span> <span class="st">"Bronze"</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">total_medals =</span> <span class="st">"Total"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"Olympic medal tally"</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="st">"Best ever national performances (1948 - 2016)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="st">"Data: www.sports-reference.com"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">everything</span>()),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(<span class="at">sides =</span> <span class="st">"bottom"</span>, <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">3</span>)),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="at">groups =</span> <span class="st">"title"</span>),</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">24</span>)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(Gold),</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Gold) <span class="sc">%&gt;%</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(Silver),</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Silver) <span class="sc">%&gt;%</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(Bronze),</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Bronze) <span class="sc">%&gt;%</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_all_caps</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_table_font</span>(</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">google_font</span>(<span class="st">"Chivo"</span>),</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">default_fonts</span>()</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(rank <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">40</span>),</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(country) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">150</span>),</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(Gold,</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>               Silver,</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>               Bronze) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_notes.font.size =</span> <span class="dv">12</span>,</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.align =</span> <span class="st">"left"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply a function to a column</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="fu">c</span>(flag_URL)),</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Return an image of set dimensions</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">web_image</span>(</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">url =</span> x,</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">12</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Hide column header flag_URL and reduce width</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(<span class="fu">c</span>(flag_URL) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">flag_URL =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="oorwtdggcz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#oorwtdggcz table {
  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oorwtdggcz thead, #oorwtdggcz tbody, #oorwtdggcz tfoot, #oorwtdggcz tr, #oorwtdggcz td, #oorwtdggcz th {
  border-style: none;
}

#oorwtdggcz p {
  margin: 0;
  padding: 0;
}

#oorwtdggcz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oorwtdggcz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oorwtdggcz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oorwtdggcz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oorwtdggcz .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oorwtdggcz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oorwtdggcz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oorwtdggcz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oorwtdggcz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oorwtdggcz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oorwtdggcz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oorwtdggcz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oorwtdggcz .gt_spanner_row {
  border-bottom-style: hidden;
}

#oorwtdggcz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oorwtdggcz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oorwtdggcz .gt_from_md > :first-child {
  margin-top: 0;
}

#oorwtdggcz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oorwtdggcz .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oorwtdggcz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oorwtdggcz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oorwtdggcz .gt_row_group_first td {
  border-top-width: 2px;
}

#oorwtdggcz .gt_row_group_first th {
  border-top-width: 2px;
}

#oorwtdggcz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oorwtdggcz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oorwtdggcz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oorwtdggcz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oorwtdggcz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oorwtdggcz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oorwtdggcz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oorwtdggcz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oorwtdggcz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oorwtdggcz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oorwtdggcz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oorwtdggcz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oorwtdggcz .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oorwtdggcz .gt_left {
  text-align: left;
}

#oorwtdggcz .gt_center {
  text-align: center;
}

#oorwtdggcz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oorwtdggcz .gt_font_normal {
  font-weight: normal;
}

#oorwtdggcz .gt_font_bold {
  font-weight: bold;
}

#oorwtdggcz .gt_font_italic {
  font-style: italic;
}

#oorwtdggcz .gt_super {
  font-size: 65%;
}

#oorwtdggcz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oorwtdggcz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oorwtdggcz .gt_indent_1 {
  text-indent: 5px;
}

#oorwtdggcz .gt_indent_2 {
  text-indent: 10px;
}

#oorwtdggcz .gt_indent_3 {
  text-indent: 15px;
}

#oorwtdggcz .gt_indent_4 {
  text-indent: 20px;
}

#oorwtdggcz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:40px;">
    <col>
    <col style="width:30px;">
    <col style="width:150px;">
    <col style="width:100px;">
    <col style="width:100px;">
    <col style="width:100px;">
    <col>
  </colgroup>
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal" style="font-size: 24; font-weight: bold;">Olympic medal tally</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Best ever national performances (1948 - 2016)</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Games">Games</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Country">Country</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Gold">Gold</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Silver">Silver</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Bronze">Bronze</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Total">Total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rank" class="gt_row gt_right">1</td>
<td headers="Game" class="gt_row gt_left">Los Angeles 1984</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FCC861; color: #000000;">82</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #E8E8E8; color: #000000;">61</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #E9CCAE; color: #000000;">30</td>
<td headers="total_medals" class="gt_row gt_right">173</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">2</td>
<td headers="Game" class="gt_row gt_left">Moscow 1980</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FCC965; color: #000000;">80</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #E5E5E5; color: #000000;">69</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #DCB386; color: #000000;">46</td>
<td headers="total_medals" class="gt_row gt_right">195</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">3</td>
<td headers="Game" class="gt_row gt_left">Seoul 1988</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFD997; color: #000000;">54</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #F2F2F2; color: #000000;">31</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #DCB386; color: #000000;">46</td>
<td headers="total_medals" class="gt_row gt_right">131</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">4</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">China</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDB9C; color: #000000;">51</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #F5F5F5; color: #000000;">21</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #EACFB3; color: #000000;">28</td>
<td headers="total_medals" class="gt_row gt_right">100</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">5</td>
<td headers="Game" class="gt_row gt_left">Munich 1972</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDC9E; color: #000000;">50</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #F3F3F3; color: #000000;">27</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #EFD8C2; color: #000000;">22</td>
<td headers="total_medals" class="gt_row gt_right">99</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">6</td>
<td headers="Game" class="gt_row gt_left">Montreal 1976</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDCA0; color: #000000;">49</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #EEEEEE; color: #000000;">41</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #E5C4A1; color: #000000;">35</td>
<td headers="total_medals" class="gt_row gt_right">125</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">7</td>
<td headers="Game" class="gt_row gt_left">Moscow 1980</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Flag_of_East_Germany.svg/44px-Flag_of_East_Germany.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">East Germany</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDEA4; color: #000000;">47</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #F0F0F0; color: #000000;">37</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #DFB990; color: #000000;">42</td>
<td headers="total_medals" class="gt_row gt_right">126</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">8</td>
<td headers="Game" class="gt_row gt_left">Rio 2016</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDEA6; color: #000000;">46</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #F0F0F0; color: #000000;">37</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #E3BF9A; color: #000000;">38</td>
<td headers="total_medals" class="gt_row gt_right">121</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">9</td>
<td headers="Game" class="gt_row gt_left">London 2012</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDEA6; color: #000000;">46</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #F3F3F3; color: #000000;">28</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #EACDB1; color: #000000;">29</td>
<td headers="total_medals" class="gt_row gt_right">103</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">10</td>
<td headers="Game" class="gt_row gt_left">Barcelona 1992</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/Olympic_flag.svg/44px-Olympic_flag.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Unified Team</td>
<td headers="Gold" class="gt_row gt_right" style="background-color: #FFDFA8; color: #000000;">45</td>
<td headers="Silver" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">38</td>
<td headers="Bronze" class="gt_row gt_right" style="background-color: #EACDB1; color: #000000;">29</td>
<td headers="total_medals" class="gt_row gt_right">112</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="8">Data: www.sports-reference.com</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="problem-1-the-problem-of-medal-inflation" class="level2">
<h2 data-anchor-id="problem-1-the-problem-of-medal-inflation">Problem 1: The Problem of (medal) Inflation</h2>
<hr>
<p>At first the topic of Olympic success seems pretty straight forward. More medals equals more success. But if we want to compare medal tallies between years we necessarily expect that the number of <em>possible</em> medals stays the same. Otherwise a country might do ‘better’ just because they participated in a particularly lucrative Olympics. Does this assumption of a fixed medal pool hold up?</p>
<p>Let’s go back to our data and look at the <em>total number</em> of Gold, Silver, and Bronze medals awarded each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>number_medals <span class="ot">&lt;-</span> medals_wide <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(Gold, Silver, Bronze), sum)) <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Convert to long format for plotting</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(Gold<span class="sc">:</span>Bronze, <span class="at">names_to =</span> <span class="st">"Medal"</span>, <span class="at">values_to =</span> <span class="st">"n_medals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> number_medals <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Medal =</span> <span class="fu">factor</span>(Medal, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Gold"</span>, <span class="st">"Silver"</span>, <span class="st">"Bronze"</span>)))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>text_data <span class="ot">&lt;-</span> plot_data <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_medals =</span> <span class="fu">sum</span>(n_medals))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data =</span> plot_data,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Year), <span class="at">y =</span> n_medals, <span class="at">fill =</span> Medal),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text_data,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Year), <span class="at">y =</span> total_medals,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> Year), <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">colour =</span> <span class="st">"grey10"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>, <span class="at">family =</span> <span class="st">"Chivo"</span>) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  shadowtext<span class="sc">::</span><span class="fu">geom_shadowtext</span>(<span class="at">data =</span> plot_data <span class="sc">|&gt;</span> </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">arrange</span>(<span class="fu">desc</span>(Medal)) <span class="sc">|&gt;</span> </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">cumsum</span>(n_medals)),</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Year),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> y, <span class="at">label =</span> Medal,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">colour =</span> Medal),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                              <span class="at">bg.colour=</span><span class="st">"grey10"</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                              <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.75</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Chivo"</span>) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The Problem of (medal) Inflation"</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="at">subtitle =</span> <span class="st">"Number of medals available at the Olympics has more than doubles since 1948"</span>) <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fcc861"</span>, <span class="st">"#e5e5e5"</span>, <span class="st">"#dcb386"</span>)) <span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fcc861"</span>, <span class="st">"#e5e5e5"</span>, <span class="st">"#dcb386"</span>)) <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Number of medals"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.075</span>, <span class="fl">0.075</span>, <span class="fl">0.075</span>, <span class="fl">0.075</span>)) <span class="sc">+</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">colour =</span> <span class="st">"grey10"</span>,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Chivo"</span>),</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">colour =</span> <span class="st">"grey10"</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Chivo"</span>),</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">b =</span> <span class="dv">10</span>, <span class="at">l =</span> <span class="dv">15</span>, <span class="at">r =</span> <span class="dv">15</span>),</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Chivo"</span>),</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">family =</span> <span class="st">"Chivo"</span>),</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>There were a total of 973 medals available in Rio 2016 (the most recent Olympics available in the data), which is 132 extra medals compared to Atlanta 1996 (841 medals) and more than <em>double</em> that available at London 1948 (439 medals).</p>
<p>Simply looking at medal <em>counts</em> is therefore misleading. Instead, let’s consider the <em>percentage</em> of medals claimed at a given Olympics.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>medals_wide_prop <span class="ot">&lt;-</span> medals_long <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Join in total number of medals</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(number_medals, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Medal"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Determine % of each medal type that a country won at those games</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## We keep 'None' but don't calculate a proportion</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## None is kept to keep countries that didn't manage to win a medal</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_medal =</span> <span class="fu">case_when</span>(Medal <span class="sc">!=</span> <span class="st">"None"</span> <span class="sc">~</span> (n<span class="sc">/</span>n_medals)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Season, ISO3c, country, Medal, perc_medal) <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Pivot wider to have column for number of medals won for each type</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Medal, <span class="at">values_from =</span> perc_medal, <span class="at">names_prefix =</span> <span class="st">"perc_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Some countries won't have any data for a medal type. Replace this with 0</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(perc_None, perc_Bronze, perc_Silver, perc_Gold), \(x) <span class="fu">replace_na</span>(x, <span class="dv">0</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Order columns more logically</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Season, ISO3c, country, perc_Gold, perc_Silver, perc_Bronze) <span class="sc">|&gt;</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Arrange to show best performing country at each games using percentage ranking</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Year), Season, <span class="fu">desc</span>(perc_Gold), <span class="fu">desc</span>(perc_Silver), <span class="fu">desc</span>(perc_Bronze))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Also join in data on % on total medals won</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>total_prop <span class="ot">&lt;-</span> medals_wide <span class="sc">|&gt;</span> </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(number_medals <span class="sc">|&gt;</span> </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>              <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n_medals)), <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_Total =</span> (total_medals<span class="sc">/</span>total)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, ISO3c, perc_Total)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>medals_wide_prop <span class="ot">&lt;-</span> medals_wide_prop <span class="sc">|&gt;</span> </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_prop, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"ISO3c"</span>))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>medals_wide_prop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,463 × 8
    Year Season ISO3c country       perc_Gold perc_Silver perc_Bronze perc_Total
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
 1  2016 Summer USA   United States     15.0       12.1         10.6       12.4 
 2  2016 Summer GBR   Great Britain      8.79       7.52         4.72       6.89
 3  2016 Summer CHN   China              8.47       5.88         7.22       7.19
 4  2016 Summer RUS   Russia             6.19       5.56         5.56       5.76
 5  2016 Summer DEU   Germany            5.54       3.27         4.17       4.32
 6  2016 Summer JPN   Japan              3.91       2.61         5.83       4.21
 7  2016 Summer FRA   France             3.26       5.88         3.89       4.32
 8  2016 Summer KOR   South Korea        2.93       0.980        2.5        2.16
 9  2016 Summer ITA   Italy              2.61       3.92         2.22       2.88
10  2016 Summer AUS   Australia          2.61       3.59         2.78       2.98
# ℹ 2,453 more rows</code></pre>
</div>
</div>
<p>We can now adapt our previous table to look at the 10 greatest national performances based on medal <em>percentage</em>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>flag_db <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/Country_Flags.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Convert country names into 3-letter country codes</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Code_raw =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Country, <span class="at">origin =</span> <span class="st">"country.name"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="do">## There are a few cases that need to be specified manually</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Code =</span> <span class="fu">case_when</span>(Country <span class="sc">==</span> <span class="st">"Soviet Union"</span> <span class="sc">~</span> <span class="st">"SUN"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"East Germany"</span> <span class="sc">~</span> <span class="st">"DDR"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"Yugoslavia"</span> <span class="sc">~</span> <span class="st">"YUG"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Code_raw)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Code, <span class="at">flag_URL =</span> ImageURL)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>games_names <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/games_names.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> medals_wide_prop <span class="sc">|&gt;</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(perc_Gold), <span class="fu">desc</span>(perc_Silver), <span class="fu">desc</span>(perc_Bronze)) <span class="sc">|&gt;</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(games_names, <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flag_db, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ISO3c"</span> <span class="ot">=</span> <span class="st">"Code"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, Game, flag_URL, country, perc_Gold, perc_Silver, perc_Bronze, perc_Total)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>perc_palette_Gold <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#fcc861"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Gold)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>perc_palette_Silver <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#e5e5e5"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Silver)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>perc_palette_Bronze <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#dcb386"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Bronze)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>plot_data <span class="sc">|&gt;</span> </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rank =</span> <span class="st">""</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">Game =</span> <span class="st">"Games"</span>,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">country =</span> <span class="st">"Country"</span>,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Gold =</span> <span class="st">"Gold (%)"</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Silver =</span> <span class="st">"Silver (%)"</span>,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Bronze =</span> <span class="st">"Bronze (%)"</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Total =</span> <span class="st">"Total (%)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"Olympic medal tally (%)"</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="st">"Best ever national performances (1948 - 2016)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="st">"Data: www.sports-reference.com"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">everything</span>()),</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(<span class="at">sides =</span> <span class="st">"bottom"</span>, <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">3</span>)),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="at">groups =</span> <span class="st">"title"</span>),</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">24</span>)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold),</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Gold) <span class="sc">%&gt;%</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Silver),</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Silver) <span class="sc">%&gt;%</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Bronze),</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Bronze) <span class="sc">%&gt;%</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold, perc_Silver, perc_Bronze, perc_Total),</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_all_caps</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_table_font</span>(</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">google_font</span>(<span class="st">"Chivo"</span>),</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">default_fonts</span>()</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(rank <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">40</span>),</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>             Game <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">150</span>),</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(country) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">125</span>),</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(perc_Gold,</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>               perc_Silver,</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>               perc_Bronze,</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>               perc_Total) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">85</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_notes.font.size =</span> <span class="dv">12</span>,</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.align =</span> <span class="st">"left"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply a function to a column</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="fu">c</span>(flag_URL)),</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Return an image of set dimensions</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">web_image</span>(</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">url =</span> x,</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">12</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Hide column header flag_URL and reduce width</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(<span class="fu">c</span>(flag_URL) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">flag_URL =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="kgltgxbowr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#kgltgxbowr table {
  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kgltgxbowr thead, #kgltgxbowr tbody, #kgltgxbowr tfoot, #kgltgxbowr tr, #kgltgxbowr td, #kgltgxbowr th {
  border-style: none;
}

#kgltgxbowr p {
  margin: 0;
  padding: 0;
}

#kgltgxbowr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kgltgxbowr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kgltgxbowr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kgltgxbowr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kgltgxbowr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kgltgxbowr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgltgxbowr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kgltgxbowr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kgltgxbowr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kgltgxbowr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kgltgxbowr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kgltgxbowr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kgltgxbowr .gt_spanner_row {
  border-bottom-style: hidden;
}

#kgltgxbowr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kgltgxbowr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kgltgxbowr .gt_from_md > :first-child {
  margin-top: 0;
}

#kgltgxbowr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kgltgxbowr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kgltgxbowr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kgltgxbowr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kgltgxbowr .gt_row_group_first td {
  border-top-width: 2px;
}

#kgltgxbowr .gt_row_group_first th {
  border-top-width: 2px;
}

#kgltgxbowr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgltgxbowr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kgltgxbowr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kgltgxbowr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgltgxbowr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgltgxbowr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kgltgxbowr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kgltgxbowr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kgltgxbowr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kgltgxbowr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kgltgxbowr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgltgxbowr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kgltgxbowr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kgltgxbowr .gt_left {
  text-align: left;
}

#kgltgxbowr .gt_center {
  text-align: center;
}

#kgltgxbowr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kgltgxbowr .gt_font_normal {
  font-weight: normal;
}

#kgltgxbowr .gt_font_bold {
  font-weight: bold;
}

#kgltgxbowr .gt_font_italic {
  font-style: italic;
}

#kgltgxbowr .gt_super {
  font-size: 65%;
}

#kgltgxbowr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kgltgxbowr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kgltgxbowr .gt_indent_1 {
  text-indent: 5px;
}

#kgltgxbowr .gt_indent_2 {
  text-indent: 10px;
}

#kgltgxbowr .gt_indent_3 {
  text-indent: 15px;
}

#kgltgxbowr .gt_indent_4 {
  text-indent: 20px;
}

#kgltgxbowr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 0px" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:40px;">
    <col style="width:150px;">
    <col style="width:30px;">
    <col style="width:125px;">
    <col style="width:85px;">
    <col style="width:85px;">
    <col style="width:85px;">
    <col style="width:85px;">
  </colgroup>
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal" style="font-size: 24; font-weight: bold;">Olympic medal tally (%)</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Best ever national performances (1948 - 2016)</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Games">Games</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Country">Country</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Gold (%)">Gold (%)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Silver (%)">Silver (%)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Bronze (%)">Bronze (%)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Total (%)">Total (%)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rank" class="gt_row gt_right">1</td>
<td headers="Game" class="gt_row gt_left">Moscow 1980</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FCC861; color: #000000;">39.22</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #E5E5E5; color: #000000;">33.82</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #DCB386; color: #000000;">20.63</td>
<td headers="perc_Total" class="gt_row gt_right">30.90</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">2</td>
<td headers="Game" class="gt_row gt_left">Los Angeles 1984</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FDCB6C; color: #000000;">36.61</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #E9E9E9; color: #000000;">27.98</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #EBD0B4; color: #000000;">12.35</td>
<td headers="perc_Total" class="gt_row gt_right">25.26</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">3</td>
<td headers="Game" class="gt_row gt_left">Rome 1960</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD68D; color: #000000;">28.29</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">19.46</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #DEB78D; color: #000000;">19.38</td>
<td headers="perc_Total" class="gt_row gt_right">22.34</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">4</td>
<td headers="Game" class="gt_row gt_left">Helsinki 1952</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD893; color: #000000;">26.85</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #F3F3F3; color: #000000;">12.58</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #EDD5BD; color: #000000;">10.83</td>
<td headers="perc_Total" class="gt_row gt_right">16.63</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">5</td>
<td headers="Game" class="gt_row gt_left">London 1948</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD995; color: #000000;">26.39</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">18.49</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #EACEB2; color: #000000;">12.75</td>
<td headers="perc_Total" class="gt_row gt_right">19.13</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">6</td>
<td headers="Game" class="gt_row gt_left">Mexico City 1968</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD997; color: #000000;">25.86</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #F1F1F1; color: #000000;">16.47</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E0BA91; color: #000000;">18.58</td>
<td headers="perc_Total" class="gt_row gt_right">20.30</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">7</td>
<td headers="Game" class="gt_row gt_left">Munich 1972</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFDA97; color: #000000;">25.64</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #F3F3F3; color: #000000;">13.85</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #EED6BF; color: #000000;">10.48</td>
<td headers="perc_Total" class="gt_row gt_right">16.50</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">8</td>
<td headers="Game" class="gt_row gt_left">Montreal 1976</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFDB9B; color: #000000;">24.75</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #EEEEEE; color: #000000;">20.60</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E4C29F; color: #000000;">16.20</td>
<td headers="perc_Total" class="gt_row gt_right">20.39</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">9</td>
<td headers="Game" class="gt_row gt_left">Melbourne 1956</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Flag_of_the_Soviet_Union.svg/44px-Flag_of_the_Soviet_Union.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Soviet Union</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFDB9D; color: #000000;">24.18</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">18.95</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #DDB68A; color: #000000;">19.88</td>
<td headers="perc_Total" class="gt_row gt_right">20.99</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">10</td>
<td headers="Game" class="gt_row gt_left">Moscow 1980</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a1/Flag_of_East_Germany.svg/44px-Flag_of_East_Germany.svg.png" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">East Germany</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFDDA2; color: #000000;">23.04</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #F0F0F0; color: #000000;">18.14</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #DFB990; color: #000000;">18.83</td>
<td headers="perc_Total" class="gt_row gt_right">19.97</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="8">Data: www.sports-reference.com</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="problem-2-the-problem-of-politics-and-pandemics" class="level2">
<h2 data-anchor-id="problem-2-the-problem-of-politics-and-pandemics">Problem 2: The Problem of Politics (and Pandemics)</h2>
<hr>
<p>We start to see performances from older Olympics (e.g.&nbsp;Melbourne 1956) making the cut once we account for the smaller number of medals available in those earlier years. Unfortunately, looking at the top two national performances we see another problem in our quest to calculate Olympic success. 4 of the top 10 national performances in our table come from Olympics marred by boycotts. The impressive display of the <a href="https://en.wikipedia.org/wiki/1980_Summer_Olympics_boycott">Soviet Union in 1980</a> and <a href="https://en.wikipedia.org/wiki/1984_Summer_Olympics_boycott">USA in 1984</a> is a bit less impressive when you remember that their major sporting rivals boycotted these games. It’s hard to compare performances from boycotted games to those with full participation.</p>
<p>Olympics is never devoid of politics, but to make things easier let’s drill down on Olympics from Atlanta 1996 onwards. This avoids major issues of Olympic boycotts and it covers a period where country borders have been a bit more stable. Because our data only goes up to Rio 2016, we also avoid the Covid disrupted event of 2020/2021.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>flag_db <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/Country_Flags.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Convert country names into 3-letter country codes</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Code_raw =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Country, <span class="at">origin =</span> <span class="st">"country.name"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="do">## There are a few cases that need to be specified manually</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Code =</span> <span class="fu">case_when</span>(Country <span class="sc">==</span> <span class="st">"Soviet Union"</span> <span class="sc">~</span> <span class="st">"SUN"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"East Germany"</span> <span class="sc">~</span> <span class="st">"DDR"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"Yugoslavia"</span> <span class="sc">~</span> <span class="st">"YUG"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Code_raw)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Code, <span class="at">flag_URL =</span> ImageURL)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>games_names <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/games_names.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> medals_wide_prop <span class="sc">|&gt;</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1996</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(perc_Gold), <span class="fu">desc</span>(perc_Silver), <span class="fu">desc</span>(perc_Bronze)) <span class="sc">|&gt;</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(games_names, <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flag_db, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ISO3c"</span> <span class="ot">=</span> <span class="st">"Code"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, Game, flag_URL, country, perc_Gold, perc_Silver, perc_Bronze, perc_Total)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>perc_palette_Gold <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#fcc861"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Gold)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>perc_palette_Silver <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#e5e5e5"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Silver)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>perc_palette_Bronze <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#dcb386"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Bronze)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>plot_data <span class="sc">|&gt;</span> </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rank =</span> <span class="st">""</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">Game =</span> <span class="st">"Games"</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">country =</span> <span class="st">"Country"</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Gold =</span> <span class="st">"Gold (%)"</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Silver =</span> <span class="st">"Silver (%)"</span>,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Bronze =</span> <span class="st">"Bronze (%)"</span>,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Total =</span> <span class="st">"Total (%)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"Olympic medal tally (%)"</span>),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="st">"Best national performances (1996 - 2016)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="st">"Data: www.sports-reference.com"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">everything</span>()),</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(<span class="at">sides =</span> <span class="st">"bottom"</span>, <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">3</span>)),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="at">groups =</span> <span class="st">"title"</span>),</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">24</span>)</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold),</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Gold) <span class="sc">%&gt;%</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Silver),</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Silver) <span class="sc">%&gt;%</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Bronze),</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Bronze) <span class="sc">%&gt;%</span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold, perc_Silver, perc_Bronze, perc_Total),</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_all_caps</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_table_font</span>(</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">google_font</span>(<span class="st">"Chivo"</span>),</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">default_fonts</span>()</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(rank <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">40</span>),</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(country, Game) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">125</span>),</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(perc_Gold,</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>               perc_Silver,</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>               perc_Bronze,</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>               perc_Total) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">85</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_notes.font.size =</span> <span class="dv">12</span>,</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.align =</span> <span class="st">"left"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply a function to a column</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="fu">c</span>(flag_URL)),</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Return an image of set dimensions</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">web_image</span>(</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>        <span class="at">url =</span> x,</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">12</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Hide column header flag_URL and reduce width</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(<span class="fu">c</span>(flag_URL) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">flag_URL =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="okdkthetpr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#okdkthetpr table {
  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#okdkthetpr thead, #okdkthetpr tbody, #okdkthetpr tfoot, #okdkthetpr tr, #okdkthetpr td, #okdkthetpr th {
  border-style: none;
}

#okdkthetpr p {
  margin: 0;
  padding: 0;
}

#okdkthetpr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#okdkthetpr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#okdkthetpr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#okdkthetpr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#okdkthetpr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#okdkthetpr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#okdkthetpr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#okdkthetpr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#okdkthetpr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#okdkthetpr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#okdkthetpr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#okdkthetpr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#okdkthetpr .gt_spanner_row {
  border-bottom-style: hidden;
}

#okdkthetpr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#okdkthetpr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#okdkthetpr .gt_from_md > :first-child {
  margin-top: 0;
}

#okdkthetpr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#okdkthetpr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#okdkthetpr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#okdkthetpr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#okdkthetpr .gt_row_group_first td {
  border-top-width: 2px;
}

#okdkthetpr .gt_row_group_first th {
  border-top-width: 2px;
}

#okdkthetpr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#okdkthetpr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#okdkthetpr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#okdkthetpr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#okdkthetpr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#okdkthetpr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#okdkthetpr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#okdkthetpr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#okdkthetpr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#okdkthetpr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#okdkthetpr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#okdkthetpr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#okdkthetpr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#okdkthetpr .gt_left {
  text-align: left;
}

#okdkthetpr .gt_center {
  text-align: center;
}

#okdkthetpr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#okdkthetpr .gt_font_normal {
  font-weight: normal;
}

#okdkthetpr .gt_font_bold {
  font-weight: bold;
}

#okdkthetpr .gt_font_italic {
  font-style: italic;
}

#okdkthetpr .gt_super {
  font-size: 65%;
}

#okdkthetpr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#okdkthetpr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#okdkthetpr .gt_indent_1 {
  text-indent: 5px;
}

#okdkthetpr .gt_indent_2 {
  text-indent: 10px;
}

#okdkthetpr .gt_indent_3 {
  text-indent: 15px;
}

#okdkthetpr .gt_indent_4 {
  text-indent: 20px;
}

#okdkthetpr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 0px" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:40px;">
    <col style="width:125px;">
    <col style="width:30px;">
    <col style="width:125px;">
    <col style="width:85px;">
    <col style="width:85px;">
    <col style="width:85px;">
    <col style="width:85px;">
  </colgroup>
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal" style="font-size: 24; font-weight: bold;">Olympic medal tally (%)</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Best national performances (1996 - 2016)</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Games">Games</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Country">Country</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Gold (%)">Gold (%)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Silver (%)">Silver (%)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Bronze (%)">Bronze (%)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Total (%)">Total (%)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rank" class="gt_row gt_right">1</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">China</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FCC861; color: #000000;">16.89</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #F0F0F0; color: #000000;">6.95</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E5C5A2; color: #000000;">7.93</td>
<td headers="perc_Total" class="gt_row gt_right">10.45</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">2</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FDCA67; color: #000000;">16.24</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #E7E7E7; color: #000000;">11.72</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E4C19D; color: #000000;">8.42</td>
<td headers="perc_Total" class="gt_row gt_right">12.01</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">3</td>
<td headers="Game" class="gt_row gt_left">London 2012</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FECD71; color: #000000;">15.23</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #ECECEC; color: #000000;">9.21</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E5C3A0; color: #000000;">8.15</td>
<td headers="perc_Total" class="gt_row gt_right">10.71</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">4</td>
<td headers="Game" class="gt_row gt_left">Rio 2016</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FECE73; color: #000000;">14.98</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #E7E7E7; color: #000000;">12.09</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #DCB386; color: #000000;">10.56</td>
<td headers="perc_Total" class="gt_row gt_right">12.44</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">5</td>
<td headers="Game" class="gt_row gt_left">London 2012</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">China</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD589; color: #000000;">12.58</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #ECECEC; color: #000000;">8.88</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #EACFB3; color: #000000;">6.46</td>
<td headers="perc_Total" class="gt_row gt_right">9.15</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">6</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD68E; color: #000000;">12.04</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #EEEEEE; color: #000000;">8.00</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E0BA91; color: #000000;">9.51</td>
<td headers="perc_Total" class="gt_row gt_right">9.84</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">7</td>
<td headers="Game" class="gt_row gt_left">Athens 2004</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD78F; color: #000000;">11.96</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #E5E5E5; color: #000000;">13.00</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E5C4A2; color: #000000;">7.98</td>
<td headers="perc_Total" class="gt_row gt_right">10.90</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">8</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFD78F; color: #000000;">11.92</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #E5E5E5; color: #000000;">12.91</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #DEB78D; color: #000000;">9.92</td>
<td headers="perc_Total" class="gt_row gt_right">11.49</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">9</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/f/f3/Flag_of_Russia.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Russia</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFDB9B; color: #000000;">10.70</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #EBEBEB; color: #000000;">9.33</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #E2BE98; color: #000000;">8.90</td>
<td headers="perc_Total" class="gt_row gt_right">9.62</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">10</td>
<td headers="Game" class="gt_row gt_left">Athens 2004</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">China</td>
<td headers="perc_Gold" class="gt_row gt_right" style="background-color: #FFDB9B; color: #000000;">10.63</td>
<td headers="perc_Silver" class="gt_row gt_right" style="background-color: #F2F2F2; color: #000000;">5.67</td>
<td headers="perc_Bronze" class="gt_row gt_right" style="background-color: #F1DECB; color: #000000;">4.29</td>
<td headers="perc_Total" class="gt_row gt_right">6.80</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="8">Data: www.sports-reference.com</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="problem-3-the-problem-of-money" class="level2">
<h2 data-anchor-id="problem-3-the-problem-of-money">Problem 3: The Problem of Money</h2>
<hr>
<p>We now see the top national performances from the past 20 years (6 Olympics) with the issue of medal inflation removed and political boycotts avoided. China and the US dominate the standings, with 9 of the top 10 performances on record. But is this really surprising considering these are the world’s two largest economies with countless amounts of money to throw at sport (and the prestige it can bring)? If we really want to measure <em>sporting</em> achievement, maybe we should remove the clear advantage available to wealthy countries. Instead of just showing medal percentage, we can instead show medal percentage <em>per $GDP</em> to account for economic opportunity.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load GDP data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## From World Bank https://databank.worldbank.org/source/world-development-indicators</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>GDP <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"./data/GDP_data.csv"</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Pivot longer to allow us to left join</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="st">`</span><span class="at">1960</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2023</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"gdp"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year)) <span class="sc">|&gt;</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>indicator_name, year, gdp) <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Remove countries with no GDP data</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gdp))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>medals_gdp <span class="ot">&lt;-</span> medals_wide_prop <span class="sc">|&gt;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Join in GDP data</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(GDP, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ISO3c"</span> <span class="ot">=</span> <span class="st">"country_code"</span>, <span class="st">"Year"</span> <span class="ot">=</span> <span class="st">"year"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Calculate medal % per billion$ GDP</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gdp_bil =</span> gdp<span class="sc">/</span><span class="fl">1e9</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_Gold_gdp =</span> perc_Gold<span class="sc">/</span>gdp_bil,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_Silver_gdp =</span> perc_Silver<span class="sc">/</span>gdp_bil,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">perc_Bronze_gdp =</span> perc_Bronze<span class="sc">/</span>gdp_bil) <span class="sc">|&gt;</span> </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Season, ISO3c, country, perc_Gold_gdp<span class="sc">:</span>perc_Bronze_gdp, <span class="fu">everything</span>())</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>medals_gdp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,463 × 14
    Year Season ISO3c country      perc_Gold_gdp perc_Silver_gdp perc_Bronze_gdp
   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
 1  2016 Summer USA   United Stat…      0.000797        0.000643        0.000561
 2  2016 Summer GBR   Great Brita…      0.00327         0.00280         0.00176 
 3  2016 Summer CHN   China             0.000754        0.000524        0.000643
 4  2016 Summer RUS   Russia            0.00485         0.00435         0.00435 
 5  2016 Summer DEU   Germany           0.00160         0.000942        0.00120 
 6  2016 Summer JPN   Japan             0.000781        0.000522        0.00117 
 7  2016 Summer FRA   France            0.00132         0.00238         0.00157 
 8  2016 Summer KOR   South Korea       0.00195         0.000654        0.00167 
 9  2016 Summer ITA   Italy             0.00139         0.00209         0.00118 
10  2016 Summer AUS   Australia         0.00216         0.00298         0.00230 
# ℹ 2,453 more rows
# ℹ 7 more variables: perc_Gold &lt;dbl&gt;, perc_Silver &lt;dbl&gt;, perc_Bronze &lt;dbl&gt;,
#   perc_Total &lt;dbl&gt;, indicator_name &lt;chr&gt;, gdp &lt;dbl&gt;, gdp_bil &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>flag_db <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/Country_Flags.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Convert country names into 3-letter country codes</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Code_raw =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Country, <span class="at">origin =</span> <span class="st">"country.name"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="do">## There are a few cases that need to be specified manually</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Code =</span> <span class="fu">case_when</span>(Country <span class="sc">==</span> <span class="st">"Soviet Union"</span> <span class="sc">~</span> <span class="st">"SUN"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"East Germany"</span> <span class="sc">~</span> <span class="st">"DDR"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"Yugoslavia"</span> <span class="sc">~</span> <span class="st">"YUG"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Code_raw)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Code, <span class="at">flag_URL =</span> ImageURL)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>games_names <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/games_names.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> medals_gdp <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medals_wide <span class="sc">|&gt;</span> <span class="fu">select</span>(Year, ISO3c, total_medals),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"ISO3c"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1996</span> <span class="sc">&amp;</span> total_medals <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(perc_Gold_gdp), <span class="fu">desc</span>(perc_Silver_gdp), <span class="fu">desc</span>(perc_Bronze_gdp)) <span class="sc">|&gt;</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">|</span> (Year <span class="sc">==</span> <span class="dv">2008</span> <span class="sc">&amp;</span> ISO3c <span class="sc">==</span> <span class="st">"CHN"</span>) <span class="sc">|</span> (Year <span class="sc">==</span> <span class="dv">1996</span> <span class="sc">&amp;</span> ISO3c <span class="sc">==</span> <span class="st">"USA"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(games_names, <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flag_db, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ISO3c"</span> <span class="ot">=</span> <span class="st">"Code"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, Game, flag_URL, country, perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Create dynamic palettes to colour Gold, Silver, and Bronze columns</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>perc_palette_Gold <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#fcc861"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Gold_gdp)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>perc_palette_Silver <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#e5e5e5"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Silver_gdp)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>perc_palette_Bronze <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#dcb386"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Bronze_gdp)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>plot_data <span class="sc">|&gt;</span> </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rank =</span> <span class="st">""</span>,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">Game =</span> <span class="st">"Games"</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">country =</span> <span class="st">"Country"</span>,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Gold_gdp =</span> <span class="fu">md</span>(<span class="st">"Gold&lt;br&gt;(%/$GDP)"</span>),</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Silver_gdp =</span> <span class="fu">md</span>(<span class="st">"Silver&lt;br&gt;(%/$GDP)"</span>),</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Bronze_gdp =</span> <span class="fu">md</span>(<span class="st">"Bronze&lt;br&gt;(%/$GDP)"</span>),</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">gdp_bil =</span> <span class="fu">md</span>(<span class="st">"GDP&lt;br&gt;(Billion $USD)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"Olympic performance (% relative to GDP)"</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Best national performances (1996 - 2016)&lt;br&gt;Considering countries that won at least 5 medals"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"Olympic data: www.sports-reference.com&lt;br&gt;GDP data: World Bank Group"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">everything</span>()),</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(<span class="at">sides =</span> <span class="st">"bottom"</span>, <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">3</span>)),</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="at">groups =</span> <span class="st">"title"</span>),</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">24</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold_gdp),</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Gold) <span class="sc">%&gt;%</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Silver_gdp),</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Silver) <span class="sc">%&gt;%</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Bronze_gdp),</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Bronze) <span class="sc">%&gt;%</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil),</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(gdp_bil), <span class="at">pattern =</span> <span class="st">"${x}"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_all_caps</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_table_font</span>(</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">google_font</span>(<span class="st">"Chivo"</span>),</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">default_fonts</span>()</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(rank <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">40</span>),</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(country, Game) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">125</span>),</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">80</span>),</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>             gdp_bil <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">110</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_notes.font.size =</span> <span class="dv">12</span>,</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.align =</span> <span class="st">"left"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply a function to a column</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="fu">c</span>(flag_URL)),</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(x) {</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Return an image of set dimensions</span></span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">web_image</span>(</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">url =</span> x,</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">12</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Hide column header flag_URL and reduce width</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(<span class="fu">c</span>(flag_URL) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">flag_URL =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="knnwomimnn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#knnwomimnn table {
  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#knnwomimnn thead, #knnwomimnn tbody, #knnwomimnn tfoot, #knnwomimnn tr, #knnwomimnn td, #knnwomimnn th {
  border-style: none;
}

#knnwomimnn p {
  margin: 0;
  padding: 0;
}

#knnwomimnn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#knnwomimnn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#knnwomimnn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#knnwomimnn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#knnwomimnn .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#knnwomimnn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#knnwomimnn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#knnwomimnn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#knnwomimnn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#knnwomimnn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#knnwomimnn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#knnwomimnn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#knnwomimnn .gt_spanner_row {
  border-bottom-style: hidden;
}

#knnwomimnn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#knnwomimnn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#knnwomimnn .gt_from_md > :first-child {
  margin-top: 0;
}

#knnwomimnn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#knnwomimnn .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#knnwomimnn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#knnwomimnn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#knnwomimnn .gt_row_group_first td {
  border-top-width: 2px;
}

#knnwomimnn .gt_row_group_first th {
  border-top-width: 2px;
}

#knnwomimnn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#knnwomimnn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#knnwomimnn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#knnwomimnn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#knnwomimnn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#knnwomimnn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#knnwomimnn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#knnwomimnn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#knnwomimnn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#knnwomimnn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#knnwomimnn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#knnwomimnn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#knnwomimnn .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#knnwomimnn .gt_left {
  text-align: left;
}

#knnwomimnn .gt_center {
  text-align: center;
}

#knnwomimnn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#knnwomimnn .gt_font_normal {
  font-weight: normal;
}

#knnwomimnn .gt_font_bold {
  font-weight: bold;
}

#knnwomimnn .gt_font_italic {
  font-style: italic;
}

#knnwomimnn .gt_super {
  font-size: 65%;
}

#knnwomimnn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#knnwomimnn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#knnwomimnn .gt_indent_1 {
  text-indent: 5px;
}

#knnwomimnn .gt_indent_2 {
  text-indent: 10px;
}

#knnwomimnn .gt_indent_3 {
  text-indent: 15px;
}

#knnwomimnn .gt_indent_4 {
  text-indent: 20px;
}

#knnwomimnn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 0px" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:40px;">
    <col style="width:125px;">
    <col style="width:30px;">
    <col style="width:125px;">
    <col style="width:80px;">
    <col style="width:80px;">
    <col style="width:80px;">
    <col style="width:110px;">
  </colgroup>
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal" style="font-size: 24; font-weight: bold;">Olympic performance (% relative to GDP)</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Best national performances (1996 - 2016)<br>Considering countries that won at least 5 medals</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Games">Games</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Country">Country</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Gold<br>(%/$GDP)">Gold<br>(%/$GDP)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Silver<br>(%/$GDP)">Silver<br>(%/$GDP)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Bronze<br>(%/$GDP)">Bronze<br>(%/$GDP)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="GDP<br>(Billion $USD)">GDP<br>(Billion $USD)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rank" class="gt_row gt_right">1</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/7/71/Flag_of_Ethiopia.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Ethiopia</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FCC861; color: #000000;">0.162</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F8F8F8; color: #000000;">0.040</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F1DDC9; color: #000000;">0.112</td>
<td headers="gdp_bil" class="gt_row gt_right">$8.24</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">2</td>
<td headers="Game" class="gt_row gt_left">Rio 2016</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Jamaica</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FECF78; color: #000000;">0.139</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F4F4F4; color: #000000;">0.070</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F8F1EA; color: #000000;">0.039</td>
<td headers="gdp_bil" class="gt_row gt_right">$14.08</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">3</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/b/bd/Flag_of_Cuba.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Cuba</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFD17E; color: #000000;">0.133</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">0.117</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F1DECB; color: #000000;">0.108</td>
<td headers="gdp_bil" class="gt_row gt_right">$25.02</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">4</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Bulgaria.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Bulgaria</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFD384; color: #000000;">0.126</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #EBEBEB; color: #000000;">0.151</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F8EFE7; color: #000000;">0.046</td>
<td headers="gdp_bil" class="gt_row gt_right">$13.25</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">5</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Jamaica</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFD58A; color: #000000;">0.121</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F7F7F7; color: #000000;">0.048</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F8F0E9; color: #000000;">0.041</td>
<td headers="gdp_bil" class="gt_row gt_right">$13.71</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">6</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/b/bd/Flag_of_Cuba.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Cuba</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFD58A; color: #000000;">0.120</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">0.120</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F5E8DC; color: #000000;">0.070</td>
<td headers="gdp_bil" class="gt_row gt_right">$30.57</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">7</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/7/73/Flag_of_Romania.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Romania</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFDC9E; color: #000000;">0.099</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F6F6F6; color: #000000;">0.054</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F5E7DA; color: #000000;">0.074</td>
<td headers="gdp_bil" class="gt_row gt_right">$37.25</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">8</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Bulgaria.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Bulgaria</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFDFA7; color: #000000;">0.090</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #E5E5E5; color: #000000;">0.209</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #EED6BE; color: #000000;">0.137</td>
<td headers="gdp_bil" class="gt_row gt_right">$12.29</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">9</td>
<td headers="Game" class="gt_row gt_left">London 2012</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Jamaica</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFDFA7; color: #000000;">0.089</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F2F2F2; color: #000000;">0.089</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F5E7D9; color: #000000;">0.076</td>
<td headers="gdp_bil" class="gt_row gt_right">$14.81</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">10</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/8/85/Flag_of_Belarus.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Belarus</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFE2B1; color: #000000;">0.079</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F3F3F3; color: #000000;">0.079</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #DCB386; color: #000000;">0.265</td>
<td headers="gdp_bil" class="gt_row gt_right">$12.74</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">124</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">China</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FDFBF8; color: #000000;">0.004</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.002</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFCFB; color: #000000;">0.002</td>
<td headers="gdp_bil" class="gt_row gt_right">$4,594.34</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">162</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FCFBFA; color: #000000;">0.002</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.001</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.001</td>
<td headers="gdp_bil" class="gt_row gt_right">$8,073.12</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="8">Olympic data: <a href="http://www.sports-reference.com">www.sports-reference.com</a><br>GDP data: World Bank Group</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
<p>We finally get a picture of the real Olympic winners! Countries that have been able to achieve sporting success despite having orders of magnitude less money to invest into expensive sporting facilities or training regimes.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This table shows the top 10 countries using our new % medal/$GDP metric, but I’ve filtered it down to show only countries that won 5 or more medals. This hopefully focuses on countries with a quality Olympic <em>team</em> rather than just one individual star. You can see the full (unfiltered) table below.</p>
</div>
</div>
<p><br></p>
</section>
<section id="the-conclusion-always-think-twice-about-statistics" class="level2">
<h2 data-anchor-id="the-conclusion-always-think-twice-about-statistics">The Conclusion: Always think twice about statistics</h2>
<hr>
<p>Headlines about record breaking medal tallies may seem catchy, but this is often just a consequence of the increasing number of sports and events being added to the Olympics (e.g.&nbsp;skateboarding, climbing). Even when countries do break new medal records (accounting for medal inflation!) a lot of these wins are only possible with hefty government investment which isn’t available in most places. Next time you’re looking at the Olympic medal tally, maybe scroll down a bit to spot those countries that are really punching above their weight.</p>
<p>Next week, we can see what our Olympic assessment method can tell us about the results of Paris 2024.</p>
<p><br> <br></p>
<hr>
</section>
<section id="appendix-top-ranked-countries-without-filtering" class="level2">
<h2 data-anchor-id="appendix-top-ranked-countries-without-filtering">Appendix: Top ranked countries without filtering</h2>
<hr>
<p>This table shows the top ranking countries based on % medals/$GDP, but including countries with small medals hauls (&lt;5). We see a few new appearances but Jamaica, Ethiopia, Cuba, and Bulgaria still feature in the top 10.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>flag_db <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/Country_Flags.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Convert country names into 3-letter country codes</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Code_raw =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Country, <span class="at">origin =</span> <span class="st">"country.name"</span>, <span class="at">destination =</span> <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="do">## There are a few cases that need to be specified manually</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Code =</span> <span class="fu">case_when</span>(Country <span class="sc">==</span> <span class="st">"Soviet Union"</span> <span class="sc">~</span> <span class="st">"SUN"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"East Germany"</span> <span class="sc">~</span> <span class="st">"DDR"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                          Country <span class="sc">==</span> <span class="st">"Yugoslavia"</span> <span class="sc">~</span> <span class="st">"YUG"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> Code_raw)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Code, <span class="at">flag_URL =</span> ImageURL)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>games_names <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/games_names.csv"</span>, <span class="at">show_col_type =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> medals_gdp <span class="sc">|&gt;</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(medals_wide <span class="sc">|&gt;</span> <span class="fu">select</span>(Year, ISO3c, total_medals),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"ISO3c"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">&gt;=</span> <span class="dv">1996</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(perc_Gold_gdp), <span class="fu">desc</span>(perc_Silver_gdp), <span class="fu">desc</span>(perc_Bronze_gdp)) <span class="sc">|&gt;</span> </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">10</span> <span class="sc">|</span> (Year <span class="sc">==</span> <span class="dv">2008</span> <span class="sc">&amp;</span> ISO3c <span class="sc">==</span> <span class="st">"CHN"</span>) <span class="sc">|</span> (Year <span class="sc">==</span> <span class="dv">1996</span> <span class="sc">&amp;</span> ISO3c <span class="sc">==</span> <span class="st">"USA"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(games_names, <span class="at">by =</span> <span class="st">"Year"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flag_db, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ISO3c"</span> <span class="ot">=</span> <span class="st">"Code"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rank, Game, flag_URL, country, perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Create dynamic palettes to colour Gold, Silver, and Bronze columns</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>perc_palette_Gold <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#fcc861"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Gold_gdp)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>perc_palette_Silver <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#e5e5e5"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Silver_gdp)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>perc_palette_Bronze <span class="ot">&lt;-</span> <span class="fu">col_numeric</span>(<span class="fu">c</span>(<span class="st">"grey99"</span>, <span class="st">"#dcb386"</span>), <span class="at">domain =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(plot_data<span class="sc">$</span>perc_Bronze_gdp)), <span class="at">alpha =</span> <span class="fl">0.75</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>plot_data <span class="sc">|&gt;</span> </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">rank =</span> <span class="st">""</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">Game =</span> <span class="st">"Games"</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">country =</span> <span class="st">"Country"</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Gold_gdp =</span> <span class="fu">md</span>(<span class="st">"Gold&lt;br&gt;(%/$GDP)"</span>),</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Silver_gdp =</span> <span class="fu">md</span>(<span class="st">"Silver&lt;br&gt;(%/$GDP)"</span>),</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">perc_Bronze_gdp =</span> <span class="fu">md</span>(<span class="st">"Bronze&lt;br&gt;(%/$GDP)"</span>),</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">gdp_bil =</span> <span class="fu">md</span>(<span class="st">"GDP&lt;br&gt;(Billion $USD)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"Olympic performance (% relative to GDP)"</span>),</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Best national performances (1996 - 2016)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source_note =</span> <span class="fu">md</span>(<span class="st">"Olympic data: www.sports-reference.com&lt;br&gt;GDP data: World Bank Group"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">everything</span>()),</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(<span class="at">sides =</span> <span class="st">"bottom"</span>, <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">3</span>)),</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="at">groups =</span> <span class="st">"title"</span>),</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">style     =</span> <span class="fu">list</span>(</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">24</span>)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold_gdp),</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Gold) <span class="sc">%&gt;%</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Silver_gdp),</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Silver) <span class="sc">%&gt;%</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Bronze_gdp),</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>             <span class="at">fn =</span> perc_palette_Bronze) <span class="sc">%&gt;%</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp, gdp_bil),</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(gdp_bil), <span class="at">pattern =</span> <span class="st">"${x}"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_all_caps</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_table_font</span>(</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">google_font</span>(<span class="st">"Chivo"</span>),</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">default_fonts</span>()</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(rank <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">40</span>),</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(country, Game) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">125</span>),</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>             <span class="fu">c</span>(perc_Gold_gdp, perc_Silver_gdp, perc_Bronze_gdp) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">80</span>),</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>             gdp_bil <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">110</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.width =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_labels.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.top.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.border.bottom.color =</span> <span class="st">"transparent"</span>,</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>),</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_notes.font.size =</span> <span class="dv">12</span>,</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading.align =</span> <span class="st">"left"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Apply a function to a column</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="fu">c</span>(flag_URL)),</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(x) {</span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Return an image of set dimensions</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">web_image</span>(</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">url =</span> x,</span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">height =</span> <span class="dv">12</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Hide column header flag_URL and reduce width</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_width</span>(<span class="fu">c</span>(flag_URL) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">flag_URL =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="alfxetfzpr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#alfxetfzpr table {
  font-family: Chivo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#alfxetfzpr thead, #alfxetfzpr tbody, #alfxetfzpr tfoot, #alfxetfzpr tr, #alfxetfzpr td, #alfxetfzpr th {
  border-style: none;
}

#alfxetfzpr p {
  margin: 0;
  padding: 0;
}

#alfxetfzpr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#alfxetfzpr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#alfxetfzpr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#alfxetfzpr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#alfxetfzpr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alfxetfzpr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alfxetfzpr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alfxetfzpr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#alfxetfzpr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#alfxetfzpr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#alfxetfzpr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#alfxetfzpr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#alfxetfzpr .gt_spanner_row {
  border-bottom-style: hidden;
}

#alfxetfzpr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#alfxetfzpr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#alfxetfzpr .gt_from_md > :first-child {
  margin-top: 0;
}

#alfxetfzpr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#alfxetfzpr .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#alfxetfzpr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#alfxetfzpr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#alfxetfzpr .gt_row_group_first td {
  border-top-width: 2px;
}

#alfxetfzpr .gt_row_group_first th {
  border-top-width: 2px;
}

#alfxetfzpr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alfxetfzpr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#alfxetfzpr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#alfxetfzpr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alfxetfzpr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alfxetfzpr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#alfxetfzpr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#alfxetfzpr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#alfxetfzpr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alfxetfzpr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alfxetfzpr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alfxetfzpr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alfxetfzpr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alfxetfzpr .gt_left {
  text-align: left;
}

#alfxetfzpr .gt_center {
  text-align: center;
}

#alfxetfzpr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#alfxetfzpr .gt_font_normal {
  font-weight: normal;
}

#alfxetfzpr .gt_font_bold {
  font-weight: bold;
}

#alfxetfzpr .gt_font_italic {
  font-style: italic;
}

#alfxetfzpr .gt_super {
  font-size: 65%;
}

#alfxetfzpr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#alfxetfzpr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#alfxetfzpr .gt_indent_1 {
  text-indent: 5px;
}

#alfxetfzpr .gt_indent_2 {
  text-indent: 10px;
}

#alfxetfzpr .gt_indent_3 {
  text-indent: 15px;
}

#alfxetfzpr .gt_indent_4 {
  text-indent: 20px;
}

#alfxetfzpr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 0px" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <colgroup>
    <col style="width:40px;">
    <col style="width:125px;">
    <col style="width:30px;">
    <col style="width:125px;">
    <col style="width:80px;">
    <col style="width:80px;">
    <col style="width:80px;">
    <col style="width:110px;">
  </colgroup>
  <thead>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_title gt_font_normal" style="font-size: 24; font-weight: bold;">Olympic performance (% relative to GDP)</td>
    </tr>
    <tr class="gt_heading">
      <td colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Best national performances (1996 - 2016)</td>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Games">Games</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Country">Country</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Gold<br>(%/$GDP)">Gold<br>(%/$GDP)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Silver<br>(%/$GDP)">Silver<br>(%/$GDP)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="Bronze<br>(%/$GDP)">Bronze<br>(%/$GDP)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-bottom-width: 3px; border-bottom-style: solid; border-bottom-color: #000000; font-weight: bold;" scope="col" id="GDP<br>(Billion $USD)">GDP<br>(Billion $USD)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="rank" class="gt_row gt_right">1</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/5/50/Flag_of_Burundi.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Burundi</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FCC861; color: #000000;">0.425</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="gdp_bil" class="gt_row gt_right">$0.87</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">2</td>
<td headers="Game" class="gt_row gt_left">London 2012</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/b/bc/Flag_of_Grenada.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Grenada</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FCC965; color: #000000;">0.414</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="gdp_bil" class="gt_row gt_right">$0.80</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">3</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Flag_of_Armenia.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Armenia</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFDFA8; color: #000000;">0.231</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #E5E5E5; color: #000000;">0.229</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="gdp_bil" class="gt_row gt_right">$1.60</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">4</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/7/71/Flag_of_Ethiopia.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Ethiopia</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFE8C1; color: #000000;">0.162</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F8F8F8; color: #000000;">0.040</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #DCB386; color: #000000;">0.112</td>
<td headers="gdp_bil" class="gt_row gt_right">$8.24</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">5</td>
<td headers="Game" class="gt_row gt_left">Rio 2016</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Jamaica</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFEBCA; color: #000000;">0.139</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F5F5F5; color: #000000;">0.070</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F3E2D1; color: #000000;">0.039</td>
<td headers="gdp_bil" class="gt_row gt_right">$14.08</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">6</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/b/bd/Flag_of_Cuba.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Cuba</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFEBCC; color: #000000;">0.133</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F0F0F0; color: #000000;">0.117</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #DDB68A; color: #000000;">0.108</td>
<td headers="gdp_bil" class="gt_row gt_right">$25.02</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">7</td>
<td headers="Game" class="gt_row gt_left">Athens 2004</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0f/Flag_of_Georgia.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Georgia</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFECCD; color: #000000;">0.130</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #EFEFEF; color: #000000;">0.130</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="gdp_bil" class="gt_row gt_right">$5.13</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">8</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/d/dd/Flag_of_Azerbaijan.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Azerbaijan</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFECCE; color: #000000;">0.127</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.000</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #EDD5BD; color: #000000;">0.058</td>
<td headers="gdp_bil" class="gt_row gt_right">$5.27</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">9</td>
<td headers="Game" class="gt_row gt_left">Sydney 2000</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Bulgaria.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Bulgaria</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFECCE; color: #000000;">0.126</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #EDEDED; color: #000000;">0.151</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F1DDCA; color: #000000;">0.046</td>
<td headers="gdp_bil" class="gt_row gt_right">$13.25</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">10</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0a/Flag_of_Jamaica.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">Jamaica</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FFEDD0; color: #000000;">0.121</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #F7F7F7; color: #000000;">0.048</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #F2E0CF; color: #000000;">0.041</td>
<td headers="gdp_bil" class="gt_row gt_right">$13.71</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">184</td>
<td headers="Game" class="gt_row gt_left">Beijing 2008</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Flag_of_the_People%27s_Republic_of_China.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">China</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FCFCFB; color: #000000;">0.004</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.002</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFBFA; color: #000000;">0.002</td>
<td headers="gdp_bil" class="gt_row gt_right">$4,594.34</td></tr>
    <tr><td headers="rank" class="gt_row gt_right">234</td>
<td headers="Game" class="gt_row gt_left">Atlanta 1996</td>
<td headers="flag_URL" class="gt_row gt_left"><img src="https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" style="height:12px;"></td>
<td headers="country" class="gt_row gt_left">United States</td>
<td headers="perc_Gold_gdp" class="gt_row gt_right" style="background-color: #FCFCFB; color: #000000;">0.002</td>
<td headers="perc_Silver_gdp" class="gt_row gt_right" style="background-color: #FCFCFC; color: #000000;">0.001</td>
<td headers="perc_Bronze_gdp" class="gt_row gt_right" style="background-color: #FCFBFB; color: #000000;">0.001</td>
<td headers="gdp_bil" class="gt_row gt_right">$8,073.12</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="8">Olympic data: <a href="http://www.sports-reference.com">www.sports-reference.com</a><br>GDP data: World Bank Group</td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/liamdbailey\.com\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->




</body></html>